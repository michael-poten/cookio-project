import{I as ce,C as K,R as y}from"./CQuVgmf0.js";import{L as ve,_ as fe,M as ge,N as Y,O as me,J as _e,P as ke,K as E,r as w,o as F,k as S,g as u,x as c,y as o,z as s,B as r,Q as d,R as a,C as l,D as v,S as j,T as L,A as R,U as O,V as pe}from"./B1Xk-5O6.js";import"./DA__SF9z.js";import{R as ye}from"./8gljmcbZ.js";function be(x){return x?ve(x).format("DD.MM.YYYY"):"-"}const he={class:"text-center"},Re={class:"text-center"},we={key:0,class:"text-center mt-8 text-high-emphasis",style:{width:"100%"}},xe={class:"mx-auto"},Ce={style:{"background-color":"rgba(93,93,93,0.66)"}},Ie={key:0,class:"px-1 pb-1"},Pe={key:1,class:"pa-1 text-white",style:{"font-size":"0.8em"}},De={class:"text-white"},ze={key:0,class:"px-1"},Ve={class:"ma-2"},Ae=["onClick"],Se={style:{width:"100%"}},Ue={style:{width:"100%"},class:"text-right mt-2"},$e={key:0,class:"text-center mt-8 text-high-emphasis",style:{width:"100%"}},Be={class:"overlay-bottom-right"},Me={key:0,style:{"background-color":"rgba(93,93,93,0.66)"},class:"px-1"},Ne={style:{"font-size":"1.1em"},class:"px-1"},Te=["href"],Ze={key:1,style:{"text-decoration-line":"none",color:"#ffffff","background-color":"rgba(93,93,93,0.66)"},class:"pa-1"},Ge={class:"overlay-top-left pa-1",style:{"font-size":"0.8em"}},Ke={style:{"background-color":"rgba(93,93,93,0.66)"},class:"pa-1"},Ye={key:0,style:{"background-color":"rgba(93,93,93,0.66)"},class:"pa-1"},je={key:2},Le={key:3},Oe={key:4},Ee={class:"ma-2"},Fe={class:"ma-2"},Je={class:"ma-2"},Qe={__name:"MealPlanner",setup(x){const D=ge(),{recipes:b}=Y(D);me(),_e(),ke();const J=E(),{authInfo:g,githubMode:z,lanAddress:Q}=Y(J);w("");const U=w({}),V=w(null),$=w(null),B=w(null),M=w(null);F(async()=>{await p()});const N=S(()=>m.value.filter(n=>!n.ordered)),h=S(()=>b.value?(b.value=b.value.sort((n,t)=>{const i=n.rating,_=t.rating,k=typeof i=="number"&&i!==null,C=typeof _=="number"&&_!==null;return!k&&!C?0:k?C?_-i:-1:1}),b.value.filter(n=>!!n.voting)):[]),m=S(()=>b.value.filter(n=>!!n.planned));function T(n){return n?z.value?"https://mmhhhh.de/data/home/recipes/"+n+"/image.jpg":Q.value+"api/"+g.value.userId+"/recipes/"+n+"/image":""}async function A(n,t=!1){z.value?window.open("https://mmhhhh.de/recipes/go?id="+n.id,"_blank","noopener"):window.open("/recipes/go?id="+n.id,"_blank","noopener")}async function q(n){const t={planned:!0,voting:0};await y.updateRecipe(g.value.userId,n,t),await p(),y.uploadRecipeToGithub(g.value.userId,null)}async function H(){$.value().then(async n=>{if(n){let t=h.value;for(const i of t){const _={voting:0};await y.updateRecipe(g.value.userId,i.id,_)}await p()}})}async function W(n){const t={voting:0};await y.updateRecipe(g.value.userId,n,t),await p()}async function X(){B.value().then(async n=>{if(n){let t=m.value;for(const i of t){const _={planned:!1,voting:0,cooked:!1,ordered:!1,preparations:[]};await y.updateRecipe(g.value.userId,i.id,_)}await p(),y.uploadRecipeToGithub(g.value.userId,null)}})}async function ee(){const n=m.value.filter(t=>!t.ordered).map(t=>t.id);n&&n.length>0&&V.value(n).then(t=>{p()})}async function Z(n){const t={planned:!1,voting:0,cooked:!1,ordered:!1,preparations:[]};await y.updateRecipe(g.value.userId,n,t),await p(),y.uploadRecipeToGithub(g.value.userId,null);for(const i of Object.keys(plansByDay.value))plansByDay.value[i]&&plansByDay.value[i].recipeId===n&&(plansByDay.value[i].cooked=!0)}async function p(){b.value=await D.getAllRecipes(g.value.userId)}function G(n){V.value(n).then(t=>{p()})}function te(n){M.value(n)}return(n,t)=>{const i=u("v-btn"),_=u("v-rating"),k=u("v-icon"),C=u("v-carousel-item"),ne=u("v-carousel"),oe=u("v-divider"),I=u("v-list-item-title"),P=u("v-list-item"),se=u("v-list"),le=u("v-menu"),ae=u("v-toolbar"),ie=u("v-img"),re=u("v-card"),de=u("v-col"),ue=u("v-row");return o(),c("div",null,[s("div",he,[t[11]||(t[11]=s("h2",{class:"mt-6 text-center"},"VorschlÃ¤ge",-1)),h.value&&h.value.length>0?(o(),d(i,{key:0,variant:"plain",class:"text-center",onClick:H},{default:l(()=>[...t[4]||(t[4]=[v("Alle Likes entfernen",-1)])]),_:1})):a("",!0),s("div",Re,[h.value.length===0?(o(),c("div",we,[...t[5]||(t[5]=[s("div",{style:{"font-size":"1.2em"}},"Keine VorschlÃ¤ge vorhanden!",-1)])])):a("",!0),h.value.length>0?(o(),d(ne,{key:1,"hide-delimiter-background":"","hide-delimiters":h.value.length===1},{default:l(()=>[(o(!0),c(j,null,L(h.value,e=>(o(),d(C,{cover:"",src:T(e?e.id:null),key:e.id},{default:l(()=>[s("div",xe,[s("div",Ce,[e.rating?(o(),c("div",Ie,[r(_,{modelValue:e.rating,"onUpdate:modelValue":f=>e.rating=f,hover:"",length:"5",size:"20",readonly:"",color:"white"},null,8,["modelValue","onUpdate:modelValue"])])):a("",!0),!e.ingredientsInProgress&&!e.sectionsInProgress&&!e.imageInProgress&&!e.sectionsUploaded?(o(),c("div",Pe,[s("span",null,[r(k,{icon:"mdi-information-slab-circle"}),t[6]||(t[6]=v()),t[7]||(t[7]=s("b",null,"Nur Zutatenliste vorhanden!",-1))])])):a("",!0),s("div",De,[e.duration?(o(),c("span",ze,[s("b",null,R(e.duration)+" Min.",1),t[8]||(t[8]=v(" | ",-1))])):a("",!0),s("span",null,[s("b",null,R(e.voting)+" x ðŸ‘",1)])])]),s("div",Ve,[s("span",{onClick:f=>A(e),style:{cursor:"pointer","text-decoration-line":"none","font-weight":"700","font-size":"2.04em",color:"#ffffff !important","background-color":"rgba(93,93,93,0.66)",hyphens:"auto","overflow-wrap":"break-word"},class:"text-medium-emphasis"},R(e.title),9,Ae)]),s("div",null,[r(i,{onClick:f=>q(e.id),variant:"flat",color:"rgba(198, 217, 238, 0.7)",height:"50"},{default:l(()=>[...t[9]||(t[9]=[v("Rezept einplanen",-1)])]),_:1},8,["onClick"])]),s("div",null,[r(i,{onClick:f=>W(e.id),variant:"flat",color:"rgb(238 198 198 / 70%)",class:"mt-1"},{default:l(()=>[...t[10]||(t[10]=[v("Ignorieren",-1)])]),_:1},8,["onClick"])])])]),_:2},1032,["src"]))),128))]),_:1},8,["hide-delimiters"])):a("",!0)])]),r(oe,{class:"mt-4"}),s("div",Se,[t[24]||(t[24]=s("h2",{class:"mt-6 text-center"},"Geplant",-1)),s("div",Ue,[m.value&&m.value.length>0?(o(),d(i,{key:0,variant:"outlined",onClick:ee,disabled:!N.value||N.value.length===0},{default:l(()=>[...t[12]||(t[12]=[v("Alle Zutaten einkaufen",-1)])]),_:1},8,["disabled"])):a("",!0),m.value&&m.value.length>0?(o(),d(i,{key:1,variant:"outlined",class:"ml-2",color:"red",onClick:X},{default:l(()=>[...t[13]||(t[13]=[v("Alle entfernen",-1)])]),_:1})):a("",!0)]),r(ue,{class:"text-center mt-2",id:"recipesDiv"},{default:l(()=>[m.value.length===0?(o(),c("div",$e,[...t[14]||(t[14]=[s("div",{style:{"font-size":"1.2em"}},"Keine geplanten Rezepte gefunden!",-1)])])):a("",!0),(o(!0),c(j,null,L(m.value,e=>(o(),d(de,{cols:"12",sm:"12",md:"6",lg:"4",xl:"3",key:e.id},{default:l(()=>[r(re,{class:"mx-auto","max-width":"374",draggable:"true",onDragstart:f=>n.onDragStart(e)},{default:l(()=>[(o(),d(ie,{class:"position-relative",height:"200",src:T(e?e.id:null),key:U.value[e.id]?U.value[e.id]:0,color:"grey",cover:""},{default:l(()=>[s("div",Be,[e.duration?(o(),c("div",Me,[s("b",null,R(e.duration)+" Min.",1)])):a("",!0),s("div",Ne,[!e.ingredientsInProgress&&!e.sectionsInProgress&&e.sectionsUploaded?(o(),c("a",{key:0,target:"_blank",href:"/recipes/go?id="+e.id,style:{"text-decoration-line":"none",color:"#ffffff","background-color":"rgba(93,93,93,0.66)"},class:"pa-1"},R(e.title),9,Te)):a("",!0),!e.ingredientsInProgress&&!e.sectionsInProgress&&!e.sectionsUploaded?(o(),c("span",Ze,R(e.title),1)):a("",!0)])]),s("div",Ge,[s("div",Ke,[e.ordered?(o(),d(k,{key:0,icon:"mdi-check-bold"})):a("",!0),e.ordered?a("",!0):(o(),d(k,{key:1,icon:"mdi-close-thick",color:"red"})),t[15]||(t[15]=v()),t[16]||(t[16]=s("b",null,"Zutaten bestellt",-1))]),e.sectionsUploaded&&!e.sectionsInProgress?(o(),c("div",Ye,[e.cooked?(o(),d(k,{key:0,icon:"mdi-check-bold"})):a("",!0),e.cooked?a("",!0):(o(),d(k,{key:1,icon:"mdi-close-thick",color:"red"})),e.cooked?a("",!0):(o(),c("b",je,"Noch nicht zubereitet")),e.cooked&&!e.lastCookedAt?(o(),c("b",Le,"Rezept zubereitet")):a("",!0),e.cooked&&e.lastCookedAt?(o(),c("b",Oe,"Zubereitet am "+R(O(be)(e.lastCookedAt)),1)):a("",!0)])):a("",!0)]),r(ae,{color:"transparent"},{append:l(()=>[r(le,null,{activator:l(({props:f})=>[!e.imageInProgress&&!e.sectionsInProgress&&!e.ingredientsInProgress?(o(),d(i,pe({key:0,icon:"mdi-dots-vertical",color:"white"},{ref_for:!0},f),{default:l(()=>[r(k,{icon:"mdi-dots-vertical",size:"35"})]),_:1},16)):a("",!0)]),default:l(()=>[r(se,null,{default:l(()=>[r(P,{onClick:f=>G(e.id)},{default:l(()=>[r(I,null,{default:l(()=>[...t[17]||(t[17]=[v("Zutaten einkaufen",-1)])]),_:1})]),_:1},8,["onClick"]),e.sectionsUploaded&&!e.sectionsInProgress?(o(),d(P,{key:0,onClick:f=>A(e,!0)},{default:l(()=>[r(I,null,{default:l(()=>[...t[18]||(t[18]=[v("Rezept zubereiten",-1)])]),_:1})]),_:1},8,["onClick"])):a("",!0),O(z)?a("",!0):(o(),d(P,{key:1,onClick:f=>te(e)},{default:l(()=>[r(I,null,{default:l(()=>[...t[19]||(t[19]=[v("Daten importieren",-1)])]),_:1})]),_:1},8,["onClick"])),r(P,{onClick:f=>Z(e.id)},{default:l(()=>[r(I,null,{default:l(()=>[...t[20]||(t[20]=[v("Aus Planung entfernen",-1)])]),_:1})]),_:1},8,["onClick"])]),_:2},1024)]),_:2},1024)]),_:2},1024)]),_:2},1032,["src"])),s("div",Ee,[!e.ordered&&!e.cooked?(o(),d(i,{key:0,variant:"outlined",onClick:f=>G(e.id)},{default:l(()=>[...t[21]||(t[21]=[v("Zutaten einkaufen",-1)])]),_:1},8,["onClick"])):a("",!0)]),s("div",Fe,[e.ordered&&!e.cooked&&e.sectionsUploaded&&!e.sectionsInProgress?(o(),d(i,{key:0,variant:"outlined",onClick:f=>A(e,!0),color:"blue"},{default:l(()=>[...t[22]||(t[22]=[v("Rezept zubereiten",-1)])]),_:1},8,["onClick"])):a("",!0)]),s("div",Je,[e.sectionsUploaded&&!e.sectionsInProgress&&e.cooked||!(e.sectionsUploaded&&!e.sectionsInProgress)&&e.ordered?(o(),d(i,{key:0,variant:"outlined",color:"red",onClick:f=>Z(e.id)},{default:l(()=>[...t[23]||(t[23]=[v("Aus Planung entfernen",-1)])]),_:1},8,["onClick"])):a("",!0)])]),_:2},1032,["onDragstart"])]),_:2},1024))),128))]),_:1})]),r(ce,{onResult:t[0]||(t[0]=e=>V.value=e)}),r(ye,{onResult:t[1]||(t[1]=e=>M.value=e)}),r(K,{onResult:t[2]||(t[2]=e=>$.value=e),title:"Bitte bestÃ¤tigen",message:"Sollen alle vorgeschlagenen Rezepte entfernt werden?"}),r(K,{onResult:t[3]||(t[3]=e=>B.value=e),title:"Bitte bestÃ¤tigen",message:"Sollen alle geplanten Rezepte aus der Planung entfernt werden?"})])}}},qe=fe(Qe,[["__scopeId","data-v-84d14e00"]]),tt={__name:"index",setup(x){return F(async()=>{E()}),(D,b)=>(o(),d(qe))}};export{tt as default};
