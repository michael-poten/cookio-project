import{I as ke,C as ye,R as x}from"./PUEIcrrp.js";import{u as be,R as Ie}from"./MNflTq6_.js";import{_ as we,K as xe,L as J,M as Re,J as Pe,N as Ce,r as R,o as W,k as ze,g as r,x as m,y as o,B as s,z as u,P as g,Q as a,C as l,D as p,O as _,A as P,R as U,S as B,T as Ve}from"./PBTyrjFC.js";const Se={class:"pa-4"},De={key:0,class:"mt-2"},Fe={class:"mt-2"},$e={key:0},Te={key:0,class:"text-center mt-8 text-high-emphasis",style:{width:"100%"}},Ue={class:"overlay-top-left"},Be={key:0},Ae={key:0,class:"px-1 pb-1",style:{"background-color":"rgba(93,93,93,0.66)"}},Ge={key:1},Ke={key:0},Me={key:1},Ne={key:0,class:"overlay-bottom-right"},Ee={style:{"background-color":"rgba(93,93,93,0.66)"},class:"px-1"},Oe={class:"overlay-bottom-left pa-1"},Ze={key:1,style:{"background-color":"rgba(93,93,93,0.66)","font-size":"0.8em"},class:"pa-1"},He={key:0},Je={key:0},We={class:"mr-0",style:{"font-weight":"600","font-size":"1.6em"}},je={key:1},Qe={key:0,class:"ma-2"},qe={style:{"font-size":"1.2em"},class:"text-medium-emphasis"},Xe={key:1,class:"ma-2"},Ye=["onClick"],Le={__name:"RecipeOverview",setup(j){const $=be(),T=xe(),{recipes:C}=J($),{authInfo:k,githubMode:f,lanAddress:Q}=J(T);Re(),Pe(),Ce();const b=R({}),A=R(null),G=R(null),K=R(null),S=R(!1),q=R([{title:"Mahlzeiten",open:!1,items:[{name:"Frühstück",selected:!1,icon:"🍳"},{name:"Vorspeise",selected:!1,icon:"🥗"},{name:"Hauptmahlzeit",selected:!1,icon:"🍽️"},{name:"Dessert",selected:!1,icon:"🍨"},{name:"Kuchen",selected:!1,icon:"🍰"},{name:"Gebäck",selected:!1,icon:"🥐"},{name:"Snack",selected:!1,icon:"🍿"},{name:"Grill",selected:!1,icon:"🔥"},{name:"Weihnachten",selected:!1,icon:"🎄"}]},{title:"Zutaten",open:!1,items:[{name:"Kartoffeln",selected:!1,icon:"🥔"},{name:"Reis",selected:!1,icon:"🍚"},{name:"Pasta",selected:!1,icon:"🍝"},{name:"Risotto",selected:!1,icon:"🍚"},{name:"Pilze",selected:!1,icon:"🍄"},{name:"Kürbis",selected:!1,icon:"🎃"},{name:"Gnocchi",selected:!1,icon:"🥔"},{name:"Spätzle",selected:!1,icon:"🍝"},{name:"Halloumi",selected:!1,icon:"🧀"},{name:"Tortellini",selected:!1,icon:"🍥"},{name:"Pesto",selected:!1,icon:"🌿"},{name:"Käse",selected:!1,icon:"🧀"}]},{title:"Zubereitungsart",open:!1,items:[{name:"Pizza",selected:!1,icon:"🍕"},{name:"Auflauf",selected:!1,icon:"🥘"},{name:"Eintopf",selected:!1,icon:"🍲"},{name:"Suppe",selected:!1,icon:"🥣"},{name:"Salat",selected:!1,icon:"🥗"},{name:"Bowl",selected:!1,icon:"🥙"},{name:"Curry",selected:!1,icon:"🍛"},{name:"Fast-Food",selected:!1,icon:"🍔"},{name:"Gourmet",selected:!1,icon:"👨‍🍳"},{name:"Wrap",selected:!1,icon:"🥙"},{name:"Sandwich",selected:!1,icon:"🥪"},{name:"Burger",selected:!1,icon:"🍔"},{name:"Thermomix",selected:!1,icon:"⚙️"},{name:"Flammkuchen",selected:!1,icon:"🍕"}]},{title:"Fleischtyp",open:!1,items:[{name:"vegetarisch",selected:!1,icon:"🥦"},{name:"vegan",selected:!1,icon:"🌱"},{name:"Tofu",selected:!1,icon:"🧈"},{name:"Soja",selected:!1,icon:"🫘"},{name:"Fisch",selected:!1,icon:"🐟"},{name:"Fleisch",selected:!1,icon:"🥩"},{name:"Hähnchenfleisch",selected:!1,icon:"🍗"},{name:"Rindfleisch",selected:!1,icon:"🥩"},{name:"Schweinefleisch",selected:!1,icon:"🍖"}]},{title:"Länderküche",open:!1,items:[{name:"italienisch",selected:!1,icon:"🇮🇹"},{name:"mediterran",selected:!1,icon:"🌿"},{name:"mexikanisch",selected:!1,icon:"🌮"},{name:"amerikanisch",selected:!1,icon:"🍟"},{name:"französisch",selected:!1,icon:"🥖"},{name:"afrikanisch",selected:!1,icon:"🪘"},{name:"arabisch",selected:!1,icon:"🧆"},{name:"deutsch",selected:!1,icon:"🥨"},{name:"griechisch",selected:!1,icon:"🥙"},{name:"asiatisch",selected:!1,icon:"🍜"},{name:"japanisch",selected:!1,icon:"🍣"},{name:"koreanisch",selected:!1,icon:"🍱"},{name:"spanisch",selected:!1,icon:"🥘"},{name:"russisch",selected:!1,icon:"🥟"},{name:"thailändisch",selected:!1,icon:"🍲"},{name:"türkisch",selected:!1,icon:"🍢"},{name:"vietnamesisch",selected:!1,icon:"🍜"},{name:"indisch",selected:!1,icon:"🍛"}]},{title:"Jahreszeiten",open:!1,items:[{name:"Winter",selected:!1,icon:"❄️"},{name:"Frühling",selected:!1,icon:"🌸"},{name:"Sommer",selected:!1,icon:"🌞"},{name:"Herbst",selected:!1,icon:"🍂"}]}]),v=R({duration:[0,120],rating:1,tags:[]});W(async()=>{await T.getAuthInfo(),w(!0)});function X(t){return f.value?"https://mmhhhh.de/data/home/recipes/"+t.id+"/image.jpg?t="+(b.value[t.id]?b.value[t.id]:0):Q.value+"api/"+k.value.userId+"/recipes/"+t.id+"/image?t="+(b.value[t.id]?b.value[t.id]:0)}const M=ze(()=>{if(!C.value)return[];let t=JSON.parse(JSON.stringify(C.value));return t=t.sort((n,c)=>{const d=n.uploaded?n.uploaded:!1,I=c.uploaded?c.uploaded:!1;if(console.log("aUploaded",d-I),I-d!==0)return I-d;const V=n.rating,h=c.rating,F=typeof V=="number"&&V!==null,y=typeof h=="number"&&h!==null;return!F&&!y?0:F?y?h-V:1:-1}).reverse(),t=t.filter(n=>{if(!n.duration&&v.value.duration[0]>0||n.duration<v.value.duration[0]||n.duration>v.value.duration[1]||f.value&&!n.uploaded)return!1;if(v.value.rating>0){const c=v.value.rating-1;if((n.rating||0)<c)return!1}return!(v.value.tags.length>0&&(!n.tags||!v.value.tags.every(c=>n.tags.includes(c))))}),t});function N(t){f.value?window.open("https://mmhhhh.de/recipes/go?id="+t.id,"_blank","noopener"):window.open("/recipes/go?id="+t.id,"_blank","noopener")}async function Y(t){if(t.planned){const n={voting:0,planned:!1,cooked:!1,ordered:!1};await x.updateRecipe(k.value.userId,t.id,n)}else{const n={voting:t.voting?t.voting+1:1};await x.updateRecipe(k.value.userId,t.id,n)}await w()}async function L(t){const n={voting:0,planned:!0};await x.updateRecipe(k.value.userId,t.id,n),await w()}async function ee(t){t.uploaded=!0,await x.uploadRecipeToGithub(k.value.userId,t.id),await w()}async function ne(t){const n={voting:0};await x.updateRecipe(k.value.userId,t.id,n),await w()}function te(t){const n=v.value.tags.indexOf(t);n===-1?v.value.tags.push(t):v.value.tags.splice(n,1)}async function w(t=!1){console.log("authInfo userId",k.value.userId),C.value=await $.getAllRecipes(k.value.userId),!f.value&&t&&D()}function E(t){A.value(t).then(async n=>{n&&(t?setTimeout(()=>{const c=[t.id];D(c)},200):D())})}async function D(t){if(!f.value&&(await w(),C.value)){const n=C.value.filter(d=>!d.ingredientsInProgress&&!d.sectionsInProgress&&!d.imageInProgress).map(d=>d.id);t&&t.forEach(d=>{n.includes(d)&&(b.value[d]?b.value[d]++:b.value[d]=1)});const c=C.value.filter(d=>d.ingredientsInProgress||d.sectionsInProgress||d.imageInProgress).map(d=>d.id);c.length>0&&(await new Promise(d=>setTimeout(d,2e3)),await D(c))}}async function O(t){K.value(t).then(async n=>{n&&(await x.deleteRecipe(k.value.userId,t),await w(),x.uploadRecipeToGithub(k.value.userId,null))})}function se(t){G.value(t)}return(t,n)=>{const c=r("v-btn"),d=r("v-app-bar-title"),I=r("v-divider"),V=r("v-app-bar"),h=r("v-list-item"),F=r("v-range-slider"),y=r("v-icon"),Z=r("v-rating"),le=r("v-expansion-panel-title"),oe=r("v-chip"),ae=r("v-chip-group"),ie=r("v-expansion-panel-text"),de=r("v-expansion-panel"),re=r("v-expansion-panels"),ue=r("v-navigation-drawer"),H=r("v-progress-circular"),z=r("v-list-item-title"),ce=r("v-list"),me=r("v-menu"),fe=r("v-toolbar"),ve=r("v-img"),ge=r("v-card"),pe=r("v-col"),_e=r("v-row"),he=r("v-fab");return o(),m("div",null,[s(V,{color:_(f)?null:"rgb(89, 135, 184)"},{default:l(()=>[s(d,null,{default:l(()=>[s(c,{to:"/recipes","prepend-icon":"mdi-chef-hat",variant:"plain"},{default:l(()=>[...n[8]||(n[8]=[p("Cookio",-1)])]),_:1})]),_:1}),s(c,{"prepend-icon":"mdi-filter-outline",onClick:n[0]||(n[0]=e=>S.value=!S.value)},{default:l(()=>[...n[9]||(n[9]=[p(" Filter ",-1)])]),_:1}),s(I,{vertical:"",class:"mx-2"}),_(f)?a("",!0):(o(),g(c,{key:0,"prepend-icon":"mdi-calendar-month",to:"/planner"},{default:l(()=>[...n[10]||(n[10]=[p(" Mahlzeiten-Planer ",-1)])]),_:1}))]),_:1},8,["color"]),s(ue,{modelValue:S.value,"onUpdate:modelValue":n[3]||(n[3]=e=>S.value=e),location:"right",width:"250"},{prepend:l(()=>[s(h,{lines:"two","prepend-icon":"mdi-text-box-search-outline",title:"Filter"})]),default:l(()=>[s(I),u("div",Se,[u("div",null,[n[11]||(n[11]=u("h4",null,[p("Dauer "),u("span",{style:{"font-size":"0.8em"}},"(Min.)")],-1)),s(F,{modelValue:v.value.duration,"onUpdate:modelValue":n[1]||(n[1]=e=>v.value.duration=e),elevation:"3",max:"120",step:"10","thumb-label":"always",class:"mt-8 px-2","hide-details":""},null,8,["modelValue"])]),s(I,{class:"mt-3"}),_(f)?a("",!0):(o(),m("div",De,[n[12]||(n[12]=u("h4",null,"Bewertung",-1)),s(Z,{modelValue:v.value.rating,"onUpdate:modelValue":n[2]||(n[2]=e=>v.value.rating=e),hover:"",length:"6",size:"40","active-color":"primary",class:"py-3"},{item:l(e=>[s(y,{color:e.isFilled?e.index===0?"#92aac5":"#1e3f66":"grey-lighten-1",size:"large"},{default:l(()=>[p(P(e.isFilled&&e.index===0?"mdi-star-off":"mdi-star"),1)]),_:2},1032,["color"])]),_:1},8,["modelValue"])])),s(I),u("div",Fe,[(o(!0),m(U,null,B(q.value,e=>(o(),m("div",{key:e.title},[s(re,{multiple:""},{default:l(()=>[s(de,{elevation:"0",modelValue:e.open,"onUpdate:modelValue":i=>e.open=i,class:"pa-0 ma-0"},{default:l(()=>[s(le,{class:"pa-0",static:""},{default:l(()=>[u("div",null,[u("h4",null,[p(P(e.title)+" ",1),e.items.some(i=>v.value.tags.includes(i.name))?(o(),m("span",$e,"("+P(e.items.filter(i=>v.value.tags.includes(i.name)).length)+")",1)):a("",!0)])])]),_:2},1024),s(ie,{class:"no-padding-content"},{default:l(()=>[s(ae,{"selected-class":"selected-chip",column:"",multiple:""},{default:l(()=>[(o(!0),m(U,null,B(e.items,i=>(o(),g(oe,{key:i.name,text:i.icon+" "+i.name,value:i.name,variant:v.value.tags.includes(i.name)?"elevated":"tonal",onClick:nn=>te(i.name)},null,8,["text","value","variant","onClick"]))),128))]),_:2},1024)]),_:2},1024)]),_:2},1032,["modelValue","onUpdate:modelValue"])]),_:2},1024)]))),128))])])]),_:1},8,["modelValue"]),s(_e,{class:"text-center"},{default:l(()=>[_(M).length===0?(o(),m("div",Te,[u("div",null,[s(y,{icon:"mdi-chef-hat",size:"50"})]),n[13]||(n[13]=u("div",{style:{"font-size":"1.8em"}},"Keine Rezepte gefunden!",-1))])):a("",!0),(o(!0),m(U,null,B(_(M),e=>(o(),g(pe,{cols:"12",md:"4",sm:"6",lg:"3",xl:"2",key:e.id},{default:l(()=>[s(ge,{class:"mx-auto","max-width":"374",color:e.uploaded?null:"#ADCEE9",border:!e.uploaded},{default:l(()=>[(o(),g(ve,{class:"position-relative",height:"200",src:X(e),key:b.value[e.id]?b.value[e.id]:0,color:"grey",cover:""},{default:l(()=>[u("div",Ue,[!_(f)&&(e.rating||!e.uploaded)?(o(),m("div",Be,[e.rating?(o(),m("div",Ae,[s(Z,{modelValue:e.rating,"onUpdate:modelValue":i=>e.rating=i,hover:"",length:"5",size:"20",readonly:"",class:"mb-1"},null,8,["modelValue","onUpdate:modelValue"])])):a("",!0)])):a("",!0),e.ingredientsInProgress||e.sectionsInProgress||e.imageInProgress?(o(),m("div",Ge,[e.sectionsInProgress||e.ingredientsInProgress?(o(),m("span",Ke,[u("span",null,[s(H,{indeterminate:"",color:"white"})]),n[14]||(n[14]=p()),n[15]||(n[15]=u("span",null,"Wird noch analysiert...",-1))])):a("",!0),e.imageInProgress?(o(),m("span",Me,[u("span",null,[s(H,{indeterminate:"",color:"white"})]),n[16]||(n[16]=p()),n[17]||(n[17]=u("span",null,"Bild wird generiert...",-1))])):a("",!0)])):a("",!0)]),e.duration?(o(),m("div",Ne,[u("div",Ee,[u("b",null,P(e.duration)+" Min.",1)])])):a("",!0),u("div",Oe,[!_(f)&&!e.uploaded&&!e.ingredientsInProgress&&!e.sectionsInProgress&&!e.imageInProgress?(o(),g(c,{key:0,class:"mb-1",onClick:i=>ee(e),style:{"background-color":"rgba(93,93,93,0.66)"}},{default:l(()=>[s(y,{icon:"mdi-upload-off",size:"30"})]),_:1},8,["onClick"])):a("",!0),!e.duration&&!e.tags&&!(e.sectionsInProgress||e.ingredientsInProgress||e.imageInProgress)?(o(),m("div",Ze,[s(y,{icon:"mdi-information-slab-circle"}),n[18]||(n[18]=p()),n[19]||(n[19]=u("b",null,"Nur Zutatenliste vorhanden!",-1))])):a("",!0)]),s(fe,{color:"transparent"},{append:l(()=>[!_(f)&&!e.imageInProgress&&!e.sectionsInProgress&&!e.ingredientsInProgress?(o(),g(c,{key:0,onClick:i=>Y(e),style:{"background-color":"rgba(93,93,93,0.66)"}},{default:l(()=>[u("div",null,[e.planned?a("",!0):(o(),m("div",He,[e.voting&&e.voting>0?(o(),m("span",Je,[u("span",We,P(e.voting),1),n[20]||(n[20]=u("span",{class:"mr-1",style:{"font-weight":"600","font-size":"1.1em"}},"x",-1))])):a("",!0),s(y,{icon:e.voting&&e.voting>0?"mdi-thumb-up":"mdi-thumb-up-outline",size:"30"},null,8,["icon"])])),e.planned?(o(),m("div",je,[s(y,{icon:"mdi-bowl-mix",size:"30",color:"blue"})])):a("",!0)])]),_:2},1032,["onClick"])):a("",!0),!_(f)&&(e.sectionsInProgress||e.ingredientsInProgress||e.imageInProgress)?(o(),g(c,{key:1,icon:"mdi-stop-circle-outline",color:"white",onClick:i=>O(e.id),variant:"plain"},null,8,["onClick"])):a("",!0),s(me,null,{activator:l(({props:i})=>[!e.imageInProgress&&!e.sectionsInProgress&&!e.ingredientsInProgress?(o(),g(c,Ve({key:0,icon:"mdi-dots-vertical",color:"white"},{ref_for:!0},i),{default:l(()=>[s(y,{icon:"mdi-dots-vertical",size:"35"})]),_:1},16)):a("",!0)]),default:l(()=>[!e.imageInProgress&&!e.sectionsInProgress?(o(),g(ce,{key:0},{default:l(()=>[e.duration||e.tags?(o(),g(h,{key:0,onClick:i=>N(e)},{default:l(()=>[s(z,null,{default:l(()=>[...n[21]||(n[21]=[p("Zubereiten",-1)])]),_:1})]),_:1},8,["onClick"])):a("",!0),!_(f)&&!e.imageInProgress&&!e.sectionsInProgress&&!e.ingredientsInProgress?(o(),g(h,{key:1,onClick:i=>L(e)},{default:l(()=>[s(z,null,{default:l(()=>[...n[22]||(n[22]=[p("Einplanen",-1)])]),_:1})]),_:1},8,["onClick"])):a("",!0),s(h,{onClick:i=>se(e.id)},{default:l(()=>[s(z,null,{default:l(()=>[...n[23]||(n[23]=[p("Zutaten einkaufen",-1)])]),_:1})]),_:1},8,["onClick"]),!_(f)&&e.voting&&e.voting>0?(o(),g(h,{key:2,onClick:i=>ne(e)},{default:l(()=>[s(z,null,{default:l(()=>[...n[24]||(n[24]=[p("Likes löschen",-1)])]),_:1})]),_:1},8,["onClick"])):a("",!0),s(I),_(f)?a("",!0):(o(),g(h,{key:3,onClick:i=>E(e)},{default:l(()=>[s(z,null,{default:l(()=>[...n[25]||(n[25]=[p("Daten importieren",-1)])]),_:1})]),_:1},8,["onClick"])),_(f)?a("",!0):(o(),g(h,{key:4,onClick:i=>O(e.id)},{default:l(()=>[s(z,null,{default:l(()=>[...n[26]||(n[26]=[p("Löschen",-1)])]),_:1})]),_:1},8,["onClick"]))]),_:2},1024)):a("",!0)]),_:2},1024)]),_:2},1024)]),_:2},1032,["src"])),!e.sectionsInProgress&&!e.sectionsUploaded?(o(),m("div",Qe,[u("span",qe,P(e.title),1)])):a("",!0),(e.duration||e.tags)&&!e.ingredientsInProgress&&!e.sectionsInProgress?(o(),m("div",Xe,[u("a",{target:"_blank",style:{"text-decoration-line":"none",color:"#000000","font-size":"1.2em",cursor:"pointer"},class:"text-medium-emphasis",onClick:i=>N(e)},P(e.title),9,Ye)])):a("",!0)]),_:2},1032,["color","border"])]),_:2},1024))),128))]),_:1}),n[27]||(n[27]=u("div",{style:{height:"70px"}},null,-1)),_(f)?a("",!0):(o(),g(he,{color:"rgb(89, 135, 184)",key:"test","prepend-icon":"mdi-cookie-plus-outline",app:!0,location:"right bottom",text:"Rezept hinzufügen",extended:"",size:"large",onClick:n[4]||(n[4]=e=>E(null))})),s(Ie,{onResult:n[5]||(n[5]=e=>A.value=e)}),s(ke,{onResult:n[6]||(n[6]=e=>G.value=e)}),s(ye,{onResult:n[7]||(n[7]=e=>K.value=e),title:"Bitte bestätigen",message:"Soll das Rezept wirklich gelöscht werden?"})])}}},en=we(Le,[["__scopeId","data-v-f83826de"]]),on={__name:"index",setup(j){return W(async()=>{}),($,T)=>(o(),g(en))}};export{on as default};
