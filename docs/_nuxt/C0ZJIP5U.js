import{I as ct,R as h}from"./ab5ccp7S.js";import{u as vt,R as ft,C as U}from"./E9RPr9Vt.js";import{_ as gt,L as j,M as mt,J as _t,N as pt,K as J,r as x,o as O,k as E,g as d,x as f,y as l,B as a,z as n,C as o,D as u,O as g,P as c,Q as i,R as F,S as G,A as R,T as kt}from"./Fhn-Nxh6.js";const yt={class:"text-center"},bt={class:"text-center"},ht={key:0,class:"text-center mt-8 text-high-emphasis",style:{width:"100%"}},Rt={class:"mx-auto"},wt={style:{"background-color":"rgba(93,93,93,0.66)"}},xt={key:0,class:"px-1 pb-1"},Ct={key:1,class:"pa-1 text-white",style:{"font-size":"0.8em"}},It={class:"text-white"},zt={key:0,class:"px-1"},Pt={class:"ma-2"},Vt=["onClick"],Dt={style:{width:"100%"}},St={style:{width:"100%"},class:"text-center"},$t={key:0,class:"text-center mt-8 text-high-emphasis",style:{width:"100%"}},At={class:"overlay-bottom-right"},Bt={key:0,style:{"background-color":"rgba(93,93,93,0.66)"},class:"px-1"},Mt={style:{"font-size":"1.1em"},class:"px-1"},Nt=["href"],Kt={key:1,style:{"text-decoration-line":"none",color:"#ffffff","background-color":"rgba(93,93,93,0.66)"},class:"pa-1"},Zt={class:"overlay-top-left pa-1",style:{"font-size":"0.8em"}},Lt={style:{"background-color":"rgba(93,93,93,0.66)"},class:"pa-1"},Tt={key:0,style:{"background-color":"rgba(93,93,93,0.66)"},class:"pa-1"},Ut={class:"ma-2"},jt={class:"ma-2"},Et={class:"ma-2"},Ft={__name:"MealPlanner",setup(Q){const D=vt(),{recipes:k}=j(D);mt(),_t(),pt();const $=J(),{authInfo:m,githubMode:C,lanAddress:q}=j($),A=x({}),B=x(null),M=x(null),N=x(null),K=x(null);O(async()=>{await $.getAuthInfo(),await p()});const y=E(()=>k.value?(k.value=k.value.sort((s,t)=>{const r=s.rating,_=t.rating,I=typeof r=="number"&&r!==null,z=typeof _=="number"&&_!==null;return!I&&!z?0:I?z?_-r:-1:1}),k.value.filter(s=>!!s.voting)):[]),w=E(()=>k.value.filter(s=>!!s.planned));function Z(s){return C.value?"https://mmhhhh.de/data/home/recipes/"+s.id+"/image.jpg":q.value+"api/"+m.value.userId+"/recipes/"+s.id+"/image"}async function S(s,t=!1){if(t){const r={cooked:!0};await h.updateRecipe(m.value.userId,s.id,r),await p()}C.value?window.open("https://mmhhhh.de/recipes/go?id="+s.id,"_blank","noopener"):window.open("/recipes/go?id="+s.id,"_blank","noopener")}async function H(s){const t={planned:!0,voting:0};await h.updateRecipe(m.value.userId,s,t),await p()}async function W(){M.value().then(async s=>{if(s){let t=y.value;for(const r of t){const _={voting:0};await h.updateRecipe(m.value.userId,r.id,_)}await p()}})}async function X(s){const t={voting:0};await h.updateRecipe(m.value.userId,s,t),await p()}async function Y(){N.value().then(async s=>{if(s){let t=w.value;for(const r of t){const _={planned:!1,voting:0,cooked:!1};await h.updateRecipe(m.value.userId,r.id,_)}await p()}})}async function L(s){const t={planned:!1,voting:0,cooked:!1,ordered:!1};await h.updateRecipe(m.value.userId,s,t),await p()}async function p(){console.log("authInfo.value.userId",m.value.userId),k.value=await D.getAllRecipes(m.value.userId)}function T(s){B.value(s).then(t=>{p()})}function tt(s){K.value(s)}return(s,t)=>{const r=d("v-btn"),_=d("v-app-bar-title"),I=d("v-app-bar"),z=d("v-rating"),b=d("v-icon"),et=d("v-carousel-item"),nt=d("v-carousel"),ot=d("v-divider"),P=d("v-list-item-title"),V=d("v-list-item"),lt=d("v-list"),st=d("v-menu"),at=d("v-toolbar"),it=d("v-img"),rt=d("v-card"),dt=d("v-col"),ut=d("v-row");return l(),f("div",null,[a(I,{color:g(C)?"rgb(89, 135, 184)":null},{default:o(()=>[a(_,null,{default:o(()=>[a(r,{to:"/recipes","prepend-icon":"mdi-chef-hat",variant:"plain"},{default:o(()=>[...t[4]||(t[4]=[u("Cookio",-1)])]),_:1})]),_:1}),a(r,{"prepend-icon":"mdi-home-search",to:"/recipes"},{default:o(()=>[...t[5]||(t[5]=[u(" Rezeptübersicht ",-1)])]),_:1})]),_:1},8,["color"]),n("div",yt,[t[13]||(t[13]=n("h2",{class:"mt-6 text-center"},"~ Vorschläge ~",-1)),g(y)&&g(y).length>0?(l(),c(r,{key:0,variant:"plain",class:"text-center",onClick:W},{default:o(()=>[...t[6]||(t[6]=[u("Alle Likes entfernen",-1)])]),_:1})):i("",!0),n("div",bt,[g(y).length===0?(l(),f("div",ht,[...t[7]||(t[7]=[n("div",{style:{"font-size":"1.2em"}},"Keine Vorschläge vorhanden!",-1)])])):i("",!0),g(y).length>0?(l(),c(nt,{key:1,"hide-delimiter-background":"","hide-delimiters":g(y).length===1},{default:o(()=>[(l(!0),f(F,null,G(g(y),e=>(l(),c(et,{cover:"",src:Z(e),key:e.id},{default:o(()=>[n("div",Rt,[n("div",wt,[e.rating?(l(),f("div",xt,[a(z,{modelValue:e.rating,"onUpdate:modelValue":v=>e.rating=v,hover:"",length:"5",size:"20",readonly:"",color:"white"},null,8,["modelValue","onUpdate:modelValue"])])):i("",!0),!e.duration&&!e.tags&&!(e.sectionsInProgress||e.ingredientsInProgress||e.imageInProgress)?(l(),f("div",Ct,[n("span",null,[a(b,{icon:"mdi-information-slab-circle"}),t[8]||(t[8]=u()),t[9]||(t[9]=n("b",null,"Nur Zutatenliste vorhanden!",-1))])])):i("",!0),n("div",It,[e.duration?(l(),f("span",zt,[n("b",null,R(e.duration)+" Min.",1),t[10]||(t[10]=u(" | ",-1))])):i("",!0),n("span",null,[n("b",null,R(e.voting)+" x 👍",1)])])]),n("div",Pt,[n("span",{onClick:v=>S(e),style:{cursor:"pointer","text-decoration-line":"none","font-weight":"700","font-size":"2.04em",color:"#ffffff !important","background-color":"rgba(93,93,93,0.66)",hyphens:"auto","overflow-wrap":"break-word"},class:"text-medium-emphasis"},R(e.title),9,Vt)]),n("div",null,[a(r,{onClick:v=>H(e.id),variant:"flat",color:"rgba(198, 217, 238, 0.7)",height:"50"},{default:o(()=>[...t[11]||(t[11]=[u("Rezept einplanen",-1)])]),_:1},8,["onClick"])]),n("div",null,[a(r,{onClick:v=>X(e.id),variant:"flat",color:"rgb(238 198 198 / 70%)",class:"mt-1"},{default:o(()=>[...t[12]||(t[12]=[u("Ignorieren",-1)])]),_:1},8,["onClick"])])])]),_:2},1032,["src"]))),128))]),_:1},8,["hide-delimiters"])):i("",!0)])]),a(ot,{class:"mt-4"}),n("div",Dt,[t[27]||(t[27]=n("h2",{class:"mt-6 text-center"},"~ Geplant ~",-1)),n("div",St,[g(w)&&g(w).length>0?(l(),c(r,{key:0,variant:"plain",class:"text-center",onClick:Y},{default:o(()=>[...t[14]||(t[14]=[u("Alle geplanten Rezepte entfernen",-1)])]),_:1})):i("",!0)]),a(ut,{class:"text-center mt-2"},{default:o(()=>[g(w).length===0?(l(),f("div",$t,[...t[15]||(t[15]=[n("div",{style:{"font-size":"1.2em"}},"Keine geplanten Rezepte gefunden!",-1)])])):i("",!0),(l(!0),f(F,null,G(g(w),e=>(l(),c(dt,{cols:"12",sm:"12",md:"6",lg:"4",xl:"3",key:e.id},{default:o(()=>[a(rt,{class:"mx-auto","max-width":"374"},{default:o(()=>[(l(),c(it,{class:"position-relative",height:"200",src:Z(e),key:A.value[e.id]?A.value[e.id]:0,color:"grey",cover:""},{default:o(()=>[n("div",At,[e.duration?(l(),f("div",Bt,[n("b",null,R(e.duration)+" Min.",1)])):i("",!0),n("div",Mt,[e.duration||e.tags?(l(),f("a",{key:0,target:"_blank",href:"/recipes/go?id="+e.id,style:{"text-decoration-line":"none",color:"#ffffff","background-color":"rgba(93,93,93,0.66)"},class:"pa-1"},R(e.title),9,Nt)):i("",!0),e.duration||e.tags?i("",!0):(l(),f("span",Kt,R(e.title),1))])]),n("div",Zt,[n("div",Lt,[e.ordered?(l(),c(b,{key:0,icon:"mdi-check-bold"})):i("",!0),e.ordered?i("",!0):(l(),c(b,{key:1,icon:"mdi-close-thick",color:"red"})),t[16]||(t[16]=u()),t[17]||(t[17]=n("b",null,"Zutaten bestellt",-1))]),e.duration||e.tags?(l(),f("div",Tt,[e.cooked?(l(),c(b,{key:0,icon:"mdi-check-bold"})):i("",!0),e.cooked?i("",!0):(l(),c(b,{key:1,icon:"mdi-close-thick",color:"red"})),t[18]||(t[18]=u()),t[19]||(t[19]=n("b",null,"Rezept zubereitet",-1))])):i("",!0)]),a(at,{color:"transparent"},{append:o(()=>[a(st,null,{activator:o(({props:v})=>[!e.imageInProgress&&!e.sectionsInProgress&&!e.ingredientsInProgress?(l(),c(r,kt({key:0,icon:"mdi-dots-vertical",color:"white"},{ref_for:!0},v),{default:o(()=>[a(b,{icon:"mdi-dots-vertical",size:"35"})]),_:1},16)):i("",!0)]),default:o(()=>[a(lt,null,{default:o(()=>[a(V,{onClick:v=>T(e.id)},{default:o(()=>[a(P,null,{default:o(()=>[...t[20]||(t[20]=[u("Zutaten einkaufen",-1)])]),_:1})]),_:1},8,["onClick"]),e.duration||e.tags?(l(),c(V,{key:0,onClick:v=>S(e,!0)},{default:o(()=>[a(P,null,{default:o(()=>[...t[21]||(t[21]=[u("Rezept zubereiten",-1)])]),_:1})]),_:1},8,["onClick"])):i("",!0),g(C)?i("",!0):(l(),c(V,{key:1,onClick:v=>tt(e)},{default:o(()=>[a(P,null,{default:o(()=>[...t[22]||(t[22]=[u("Daten importieren",-1)])]),_:1})]),_:1},8,["onClick"])),a(V,{onClick:v=>L(e.id)},{default:o(()=>[a(P,null,{default:o(()=>[...t[23]||(t[23]=[u("Aus Planung entfernen",-1)])]),_:1})]),_:1},8,["onClick"])]),_:2},1024)]),_:2},1024)]),_:2},1024)]),_:2},1032,["src"])),n("div",Ut,[e.ordered?i("",!0):(l(),c(r,{key:0,variant:"outlined",onClick:v=>T(e.id)},{default:o(()=>[...t[24]||(t[24]=[u("Zutaten einkaufen",-1)])]),_:1},8,["onClick"]))]),n("div",jt,[e.ordered&&!e.cooked&&(e.duration||e.tags)?(l(),c(r,{key:0,variant:"outlined",onClick:v=>S(e,!0),color:"blue"},{default:o(()=>[...t[25]||(t[25]=[u("Rezept zubereiten",-1)])]),_:1},8,["onClick"])):i("",!0)]),n("div",Et,[(e.duration||e.tags)&&e.cooked||!(e.duration||e.tags)&&e.ordered?(l(),c(r,{key:0,variant:"outlined",onClick:v=>L(e.id)},{default:o(()=>[...t[26]||(t[26]=[u("Aus Planung entfernen",-1)])]),_:1},8,["onClick"])):i("",!0)])]),_:2},1024)]),_:2},1024))),128))]),_:1})]),a(ct,{onResult:t[0]||(t[0]=e=>B.value=e)}),a(ft,{onResult:t[1]||(t[1]=e=>K.value=e)}),a(U,{onResult:t[2]||(t[2]=e=>M.value=e),title:"Bitte bestätigen",message:"Sollen alle vorgeschlagenen Rezepte entfernt werden?"}),a(U,{onResult:t[3]||(t[3]=e=>N.value=e),title:"Bitte bestätigen",message:"Sollen alle geplanten Rezepte aus der Planung entfernt werden?"})])}}},Gt=gt(Ft,[["__scopeId","data-v-94d19b30"]]),qt={__name:"index",setup(Q){return O(async()=>{J()}),(D,k)=>(l(),c(Gt))}};export{qt as default};
