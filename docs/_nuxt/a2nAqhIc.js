import{I as ke,R as z}from"./CxAS5bob.js";import{u as ye,R as be,C as Ie}from"./DJGAkvde.js";import{_ as we,K as xe,L as H,M as Re,J as Pe,N as Ce,r as w,o as J,k as ze,g as r,x as c,y as o,B as s,z as u,P as v,Q as i,C as l,D as _,O as p,A as x,R as T,S as B,T as Ve}from"./DoYd0qKa.js";const Se={class:"pa-4"},Fe={key:0,class:"mt-2"},$e={class:"mt-2"},De={key:0},Te={key:0,class:"text-center mt-8 text-high-emphasis",style:{width:"100%"}},Be={class:"overlay-top-left"},Ue={key:0},Ge={key:0,class:"px-1 pb-1",style:{"background-color":"rgba(93,93,93,0.66)"}},Ke={key:1},Me={key:0},Ne={key:1},Ae={key:0,class:"overlay-bottom-right"},Oe={style:{"background-color":"rgba(93,93,93,0.66)"},class:"px-1"},Ze={class:"overlay-bottom-left pa-1"},Ee={key:1,style:{"background-color":"rgba(93,93,93,0.66)","font-size":"0.8em"},class:"pa-1"},He={key:0,class:"mr-0",style:{"font-weight":"600","font-size":"1.6em"}},Je={key:1,class:"mr-1",style:{"font-weight":"600","font-size":"1.1em"}},We={key:0,class:"ma-2"},je={style:{"font-size":"1.2em"},class:"text-medium-emphasis"},Qe={key:1,class:"ma-2"},qe=["onClick"],Xe={__name:"RecipeOverview",setup(W){const $=ye(),D=xe(),{recipes:R}=H($),{authInfo:k,githubMode:g,lanAddress:j}=H(D);Re(),Pe(),Ce();const y=w({}),U=w(null),G=w(null),K=w(null),V=w(!1),Q=w([{title:"Mahlzeiten",open:!1,items:[{name:"Frühstück",selected:!1,icon:"🍳"},{name:"Vorspeise",selected:!1,icon:"🥗"},{name:"Hauptmahlzeit",selected:!1,icon:"🍽️"},{name:"Dessert",selected:!1,icon:"🍨"},{name:"Kuchen",selected:!1,icon:"🍰"},{name:"Gebäck",selected:!1,icon:"🥐"},{name:"Snack",selected:!1,icon:"🍿"},{name:"Grill",selected:!1,icon:"🔥"},{name:"Weihnachten",selected:!1,icon:"🎄"}]},{title:"Zutaten",open:!1,items:[{name:"Kartoffeln",selected:!1,icon:"🥔"},{name:"Reis",selected:!1,icon:"🍚"},{name:"Pasta",selected:!1,icon:"🍝"},{name:"Risotto",selected:!1,icon:"🍚"},{name:"Pilze",selected:!1,icon:"🍄"},{name:"Kürbis",selected:!1,icon:"🎃"},{name:"Gnocchi",selected:!1,icon:"🥔"},{name:"Spätzle",selected:!1,icon:"🍝"},{name:"Halloumi",selected:!1,icon:"🧀"},{name:"Tortellini",selected:!1,icon:"🍥"},{name:"Pesto",selected:!1,icon:"🌿"},{name:"Käse",selected:!1,icon:"🧀"}]},{title:"Zubereitungsart",open:!1,items:[{name:"Pizza",selected:!1,icon:"🍕"},{name:"Auflauf",selected:!1,icon:"🥘"},{name:"Eintopf",selected:!1,icon:"🍲"},{name:"Suppe",selected:!1,icon:"🥣"},{name:"Salat",selected:!1,icon:"🥗"},{name:"Bowl",selected:!1,icon:"🥙"},{name:"Curry",selected:!1,icon:"🍛"},{name:"Fast-Food",selected:!1,icon:"🍔"},{name:"Gourmet",selected:!1,icon:"👨‍🍳"},{name:"Wrap",selected:!1,icon:"🥙"},{name:"Sandwich",selected:!1,icon:"🥪"},{name:"Burger",selected:!1,icon:"🍔"},{name:"Thermomix",selected:!1,icon:"⚙️"},{name:"Flammkuchen",selected:!1,icon:"🍕"}]},{title:"Fleischtyp",open:!1,items:[{name:"vegetarisch",selected:!1,icon:"🥦"},{name:"vegan",selected:!1,icon:"🌱"},{name:"Tofu",selected:!1,icon:"🧈"},{name:"Soja",selected:!1,icon:"🫘"},{name:"Fisch",selected:!1,icon:"🐟"},{name:"Fleisch",selected:!1,icon:"🥩"},{name:"Hähnchenfleisch",selected:!1,icon:"🍗"},{name:"Rindfleisch",selected:!1,icon:"🥩"},{name:"Schweinefleisch",selected:!1,icon:"🍖"}]},{title:"Länderküche",open:!1,items:[{name:"italienisch",selected:!1,icon:"🇮🇹"},{name:"mediterran",selected:!1,icon:"🌿"},{name:"mexikanisch",selected:!1,icon:"🌮"},{name:"amerikanisch",selected:!1,icon:"🍟"},{name:"französisch",selected:!1,icon:"🥖"},{name:"afrikanisch",selected:!1,icon:"🪘"},{name:"arabisch",selected:!1,icon:"🧆"},{name:"deutsch",selected:!1,icon:"🥨"},{name:"griechisch",selected:!1,icon:"🥙"},{name:"asiatisch",selected:!1,icon:"🍜"},{name:"japanisch",selected:!1,icon:"🍣"},{name:"koreanisch",selected:!1,icon:"🍱"},{name:"spanisch",selected:!1,icon:"🥘"},{name:"russisch",selected:!1,icon:"🥟"},{name:"thailändisch",selected:!1,icon:"🍲"},{name:"türkisch",selected:!1,icon:"🍢"},{name:"vietnamesisch",selected:!1,icon:"🍜"},{name:"indisch",selected:!1,icon:"🍛"}]},{title:"Jahreszeiten",open:!1,items:[{name:"Winter",selected:!1,icon:"❄️"},{name:"Frühling",selected:!1,icon:"🌸"},{name:"Sommer",selected:!1,icon:"🌞"},{name:"Herbst",selected:!1,icon:"🍂"}]}]),f=w({duration:[0,120],rating:1,tags:[]});J(async()=>{await D.getAuthInfo(),I()});function q(t){return g.value?"https://mmhhhh.de/data/home/recipes/"+t.id+"/image.jpg?t="+(y.value[t.id]?y.value[t.id]:0):j.value+"api/"+k.value.userId+"/recipes/"+t.id+"/image?t="+(y.value[t.id]?y.value[t.id]:0)}const M=ze(()=>{if(!R.value)return[];let t=JSON.parse(JSON.stringify(R.value));return t=t.sort((n,m)=>{const d=n.rating,b=m.rating,F=typeof d=="number"&&d!==null,h=typeof b=="number"&&b!==null;return!F&&!h?0:F?h?b-d:1:-1}).reverse(),t=t.filter(n=>{if(!n.duration&&f.value.duration[0]>0||n.duration<f.value.duration[0]||n.duration>f.value.duration[1]||g.value&&!n.uploaded)return!1;if(f.value.rating>0){const m=f.value.rating-1;if((n.rating||0)<m)return!1}return!(f.value.tags.length>0&&(!n.tags||!f.value.tags.every(m=>n.tags.includes(m))))}),t});function N(t){g.value?window.open("https://mmhhhh.de/recipes/go?id="+t.id,"_blank","noopener"):window.open("/recipes/go?id="+t.id,"_blank","noopener")}async function X(t){const n={voting:t.voting?t.voting+1:1};await z.updateRecipe(k.value.userId,t.id,n),await I()}async function Y(t){const n={voting:0,planned:!0};await z.updateRecipe(k.value.userId,t.id,n),await I()}async function L(t){t.uploaded=!0,await z.uploadRecipeToGithub(k.value.userId,t.id),await I()}async function ee(t){const n={voting:0};await z.updateRecipe(k.value.userId,t.id,n),await I()}function ne(t){const n=f.value.tags.indexOf(t);n===-1?f.value.tags.push(t):f.value.tags.splice(n,1)}async function I(){console.log("authInfo userId",k.value.userId),R.value=await $.getAllRecipes(k.value.userId),S()}function A(t){U.value(t).then(async n=>{n&&(t?setTimeout(()=>{const m=[t.id];S(m)},200):S())})}async function S(t){if(await I(),R.value){const n=R.value.filter(d=>!d.ingredientsInProgress&&!d.sectionsInProgress&&!d.imageInProgress).map(d=>d.id);t&&t.forEach(d=>{n.includes(d)&&(y.value[d]?y.value[d]++:y.value[d]=1)});const m=R.value.filter(d=>d.ingredientsInProgress||d.sectionsInProgress||d.imageInProgress).map(d=>d.id);m.length>0&&(await new Promise(d=>setTimeout(d,2e3)),await S(m))}}async function O(t){K.value(t).then(async n=>{n&&(await z.deleteRecipe(k.value.userId,t),await I(),z.uploadRecipeToGithub(k.value.userId,null))})}function te(t){G.value(t)}return(t,n)=>{const m=r("v-btn"),d=r("v-app-bar-title"),b=r("v-divider"),F=r("v-app-bar"),h=r("v-list-item"),se=r("v-range-slider"),P=r("v-icon"),Z=r("v-rating"),le=r("v-expansion-panel-title"),oe=r("v-chip"),ae=r("v-chip-group"),ie=r("v-expansion-panel-text"),de=r("v-expansion-panel"),re=r("v-expansion-panels"),ue=r("v-navigation-drawer"),E=r("v-progress-circular"),C=r("v-list-item-title"),ce=r("v-list"),me=r("v-menu"),fe=r("v-toolbar"),ve=r("v-img"),ge=r("v-card"),_e=r("v-col"),pe=r("v-row"),he=r("v-fab");return o(),c("div",null,[s(F,{color:p(g)?"rgb(89, 135, 184)":null},{default:l(()=>[s(d,null,{default:l(()=>[s(m,{to:"/recipes","prepend-icon":"mdi-chef-hat",variant:"plain"},{default:l(()=>[...n[8]||(n[8]=[_("Cookio",-1)])]),_:1})]),_:1}),s(m,{"prepend-icon":"mdi-filter-outline",onClick:n[0]||(n[0]=e=>V.value=!V.value)},{default:l(()=>[...n[9]||(n[9]=[_(" Filter ",-1)])]),_:1}),s(b,{vertical:"",class:"mx-2"}),p(g)?i("",!0):(o(),v(m,{key:0,"prepend-icon":"mdi-calendar-month",to:"/planner"},{default:l(()=>[...n[10]||(n[10]=[_(" Mahlzeiten-Planer ",-1)])]),_:1}))]),_:1},8,["color"]),s(ue,{modelValue:V.value,"onUpdate:modelValue":n[3]||(n[3]=e=>V.value=e),location:"right",width:"250"},{prepend:l(()=>[s(h,{lines:"two","prepend-icon":"mdi-text-box-search-outline",title:"Filter"})]),default:l(()=>[s(b),u("div",Se,[u("div",null,[n[11]||(n[11]=u("h4",null,[_("Dauer "),u("span",{style:{"font-size":"0.8em"}},"(Min.)")],-1)),s(se,{modelValue:f.value.duration,"onUpdate:modelValue":n[1]||(n[1]=e=>f.value.duration=e),elevation:"3",max:"120",step:"10","thumb-label":"always",class:"mt-8 px-2","hide-details":""},null,8,["modelValue"])]),s(b,{class:"mt-3"}),p(g)?i("",!0):(o(),c("div",Fe,[n[12]||(n[12]=u("h4",null,"Bewertung",-1)),s(Z,{modelValue:f.value.rating,"onUpdate:modelValue":n[2]||(n[2]=e=>f.value.rating=e),hover:"",length:"6",size:"40","active-color":"primary",class:"py-3"},{item:l(e=>[s(P,{color:e.isFilled?e.index===0?"#92aac5":"#1e3f66":"grey-lighten-1",size:"large"},{default:l(()=>[_(x(e.isFilled&&e.index===0?"mdi-star-off":"mdi-star"),1)]),_:2},1032,["color"])]),_:1},8,["modelValue"])])),s(b),u("div",$e,[(o(!0),c(T,null,B(Q.value,e=>(o(),c("div",{key:e.title},[s(re,{multiple:""},{default:l(()=>[s(de,{elevation:"0",modelValue:e.open,"onUpdate:modelValue":a=>e.open=a,class:"pa-0 ma-0"},{default:l(()=>[s(le,{class:"pa-0",static:""},{default:l(()=>[u("div",null,[u("h4",null,[_(x(e.title)+" ",1),e.items.some(a=>f.value.tags.includes(a.name))?(o(),c("span",De,"("+x(e.items.filter(a=>f.value.tags.includes(a.name)).length)+")",1)):i("",!0)])])]),_:2},1024),s(ie,{class:"no-padding-content"},{default:l(()=>[s(ae,{"selected-class":"selected-chip",column:"",multiple:""},{default:l(()=>[(o(!0),c(T,null,B(e.items,a=>(o(),v(oe,{key:a.name,text:a.icon+" "+a.name,value:a.name,variant:f.value.tags.includes(a.name)?"elevated":"tonal",onClick:Le=>ne(a.name)},null,8,["text","value","variant","onClick"]))),128))]),_:2},1024)]),_:2},1024)]),_:2},1032,["modelValue","onUpdate:modelValue"])]),_:2},1024)]))),128))])])]),_:1},8,["modelValue"]),s(pe,{class:"text-center"},{default:l(()=>[p(M).length===0?(o(),c("div",Te,[u("div",null,[s(P,{icon:"mdi-chef-hat",size:"50"})]),n[13]||(n[13]=u("div",{style:{"font-size":"1.8em"}},"Keine Rezepte gefunden!",-1))])):i("",!0),(o(!0),c(T,null,B(p(M),e=>(o(),v(_e,{cols:"12",md:"4",sm:"6",lg:"3",xl:"2",key:e.id},{default:l(()=>[s(ge,{class:"mx-auto","max-width":"374"},{default:l(()=>[(o(),v(ve,{class:"position-relative",height:"200",src:q(e),key:y.value[e.id]?y.value[e.id]:0,color:"grey",cover:""},{default:l(()=>[u("div",Be,[!p(g)&&(e.rating||!e.uploaded)?(o(),c("div",Ue,[e.rating?(o(),c("div",Ge,[s(Z,{modelValue:e.rating,"onUpdate:modelValue":a=>e.rating=a,hover:"",length:"5",size:"20",readonly:"",class:"mb-1"},null,8,["modelValue","onUpdate:modelValue"])])):i("",!0)])):i("",!0),e.ingredientsInProgress||e.sectionsInProgress||e.imageInProgress?(o(),c("div",Ke,[e.sectionsInProgress||e.ingredientsInProgress?(o(),c("span",Me,[u("span",null,[s(E,{indeterminate:"",color:"white"})]),n[14]||(n[14]=_()),n[15]||(n[15]=u("span",null,"Wird noch analysiert...",-1))])):i("",!0),e.imageInProgress?(o(),c("span",Ne,[u("span",null,[s(E,{indeterminate:"",color:"white"})]),n[16]||(n[16]=_()),n[17]||(n[17]=u("span",null,"Bild wird generiert...",-1))])):i("",!0)])):i("",!0)]),e.duration?(o(),c("div",Ae,[u("div",Oe,[u("b",null,x(e.duration)+" Min.",1)])])):i("",!0),u("div",Ze,[!p(g)&&!e.uploaded&&!e.ingredientsInProgress&&!e.sectionsInProgress&&!e.imageInProgress?(o(),v(m,{key:0,class:"mb-1",onClick:a=>L(e),style:{"background-color":"rgba(93,93,93,0.66)"}},{default:l(()=>[s(P,{icon:"mdi-upload-off",size:"30"})]),_:1},8,["onClick"])):i("",!0),!e.duration&&!e.tags&&!(e.sectionsInProgress||e.ingredientsInProgress||e.imageInProgress)?(o(),c("div",Ee,[s(P,{icon:"mdi-information-slab-circle"}),n[18]||(n[18]=_()),n[19]||(n[19]=u("b",null,"Nur Zutatenliste vorhanden!",-1))])):i("",!0)]),s(fe,{color:"transparent"},{append:l(()=>[!p(g)&&!e.imageInProgress&&!e.sectionsInProgress&&!e.ingredientsInProgress?(o(),v(m,{key:0,onClick:a=>X(e),style:{"background-color":"rgba(93,93,93,0.66)"}},{default:l(()=>[e.voting&&e.voting>0?(o(),c("span",He,x(e.voting),1)):i("",!0),e.voting&&e.voting>0?(o(),c("span",Je,"x")):i("",!0),s(P,{icon:e.voting&&e.voting>0?"mdi-thumb-up":"mdi-thumb-up-outline",size:"30"},null,8,["icon"])]),_:2},1032,["onClick"])):i("",!0),!p(g)&&(e.sectionsInProgress||e.ingredientsInProgress||e.imageInProgress)?(o(),v(m,{key:1,icon:"mdi-stop-circle-outline",color:"white",onClick:a=>O(e.id),variant:"plain"},null,8,["onClick"])):i("",!0),s(me,null,{activator:l(({props:a})=>[!e.imageInProgress&&!e.sectionsInProgress&&!e.ingredientsInProgress?(o(),v(m,Ve({key:0,icon:"mdi-dots-vertical",color:"white"},{ref_for:!0},a),{default:l(()=>[s(P,{icon:"mdi-dots-vertical",size:"35"})]),_:1},16)):i("",!0)]),default:l(()=>[!e.imageInProgress&&!e.sectionsInProgress?(o(),v(ce,{key:0},{default:l(()=>[e.duration||e.tags?(o(),v(h,{key:0,onClick:a=>N(e)},{default:l(()=>[s(C,null,{default:l(()=>[...n[20]||(n[20]=[_("Zubereiten",-1)])]),_:1})]),_:1},8,["onClick"])):i("",!0),!p(g)&&!e.imageInProgress&&!e.sectionsInProgress&&!e.ingredientsInProgress?(o(),v(h,{key:1,onClick:a=>Y(e)},{default:l(()=>[s(C,null,{default:l(()=>[...n[21]||(n[21]=[_("Einplanen",-1)])]),_:1})]),_:1},8,["onClick"])):i("",!0),s(h,{onClick:a=>te(e.id)},{default:l(()=>[s(C,null,{default:l(()=>[...n[22]||(n[22]=[_("Zutaten einkaufen",-1)])]),_:1})]),_:1},8,["onClick"]),!p(g)&&e.voting&&e.voting>0?(o(),v(h,{key:2,onClick:a=>ee(e)},{default:l(()=>[s(C,null,{default:l(()=>[...n[23]||(n[23]=[_("Likes löschen",-1)])]),_:1})]),_:1},8,["onClick"])):i("",!0),s(b),p(g)?i("",!0):(o(),v(h,{key:3,onClick:a=>A(e)},{default:l(()=>[s(C,null,{default:l(()=>[...n[24]||(n[24]=[_("Daten importieren",-1)])]),_:1})]),_:1},8,["onClick"])),p(g)?i("",!0):(o(),v(h,{key:4,onClick:a=>O(e.id)},{default:l(()=>[s(C,null,{default:l(()=>[...n[25]||(n[25]=[_("Löschen",-1)])]),_:1})]),_:1},8,["onClick"]))]),_:2},1024)):i("",!0)]),_:2},1024)]),_:2},1024)]),_:2},1032,["src"])),!e.sectionsInProgress&&!e.sectionsUploaded?(o(),c("div",We,[u("span",je,x(e.title),1)])):i("",!0),(e.duration||e.tags)&&!e.ingredientsInProgress&&!e.sectionsInProgress?(o(),c("div",Qe,[u("a",{target:"_blank",style:{"text-decoration-line":"none",color:"#000000","font-size":"1.2em",cursor:"pointer"},class:"text-medium-emphasis",onClick:a=>N(e)},x(e.title),9,qe)])):i("",!0)]),_:2},1024)]),_:2},1024))),128))]),_:1}),n[26]||(n[26]=u("div",{style:{height:"70px"}},null,-1)),p(g)?i("",!0):(o(),v(he,{color:"rgb(89, 135, 184)",key:"test","prepend-icon":"mdi-cookie-plus-outline",app:!0,location:"right bottom",text:"Rezept hinzufügen",extended:"",size:"large",onClick:n[4]||(n[4]=e=>A(null))})),s(be,{onResult:n[5]||(n[5]=e=>U.value=e)}),s(ke,{onResult:n[6]||(n[6]=e=>G.value=e)}),s(Ie,{onResult:n[7]||(n[7]=e=>K.value=e),title:"Bitte bestätigen",message:"Soll das Rezept wirklich gelöscht werden?"})])}}},Ye=we(Xe,[["__scopeId","data-v-20fa7654"]]),sn={__name:"index",setup(W){return J(async()=>{}),($,D)=>(o(),v(Ye))}};export{sn as default};
