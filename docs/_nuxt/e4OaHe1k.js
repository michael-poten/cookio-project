import{I as ft,C as j,R as y}from"./CSJTTG3X.js";import{u as gt,R as mt}from"./CrRb6Oxy.js";import{L as _t,_ as kt,M as O,N as pt,J as yt,O as bt,K as J,r as x,o as Q,k as M,g as u,x as f,y as n,B as i,z as s,C as l,D as c,P as v,Q as d,R as a,S as E,T as F,A as R,U as ht}from"./S_xy22RE.js";function Rt(C){return C?_t(C).format("DD.MM.YYYY"):"-"}const wt={class:"text-center"},xt={class:"text-center"},Ct={key:0,class:"text-center mt-8 text-high-emphasis",style:{width:"100%"}},It={class:"mx-auto"},zt={style:{"background-color":"rgba(93,93,93,0.66)"}},Pt={key:0,class:"px-1 pb-1"},Vt={key:1,class:"pa-1 text-white",style:{"font-size":"0.8em"}},Dt={class:"text-white"},At={key:0,class:"px-1"},St={class:"ma-2"},$t=["onClick"],Mt={style:{width:"100%"}},Nt={style:{width:"100%"},class:"text-right mt-2"},Bt={key:0,class:"text-center mt-8 text-high-emphasis",style:{width:"100%"}},Tt={class:"overlay-bottom-right"},Zt={key:0,style:{"background-color":"rgba(93,93,93,0.66)"},class:"px-1"},Gt={style:{"font-size":"1.1em"},class:"px-1"},Kt=["href"],Ut={key:1,style:{"text-decoration-line":"none",color:"#ffffff","background-color":"rgba(93,93,93,0.66)"},class:"pa-1"},Yt={class:"overlay-top-left pa-1",style:{"font-size":"0.8em"}},Lt={style:{"background-color":"rgba(93,93,93,0.66)"},class:"pa-1"},jt={key:0,style:{"background-color":"rgba(93,93,93,0.66)"},class:"pa-1"},Ot={key:2},Et={key:3},Ft={key:4},Jt={class:"ma-2"},Qt={class:"ma-2"},qt={class:"ma-2"},Ht={__name:"MealPlanner",setup(C){const A=gt(),{recipes:b}=O(A);pt(),yt(),bt();const N=J(),{authInfo:m,githubMode:I,lanAddress:q}=O(N),B=x({}),S=x(null),T=x(null),Z=x(null),G=x(null);Q(async()=>{await N.getAuthInfo(),await p()});const K=M(()=>_.value.filter(o=>!o.ordered)),h=M(()=>b.value?(b.value=b.value.sort((o,e)=>{const r=o.rating,k=e.rating,z=typeof r=="number"&&r!==null,P=typeof k=="number"&&k!==null;return!z&&!P?0:z?P?k-r:-1:1}),b.value.filter(o=>!!o.voting)):[]),_=M(()=>b.value.filter(o=>!!o.planned));function U(o){return I.value?"https://mmhhhh.de/data/home/recipes/"+o.id+"/image.jpg":q.value+"api/"+m.value.userId+"/recipes/"+o.id+"/image"}async function $(o,e=!1){I.value?window.open("https://mmhhhh.de/recipes/go?id="+o.id,"_blank","noopener"):window.open("/recipes/go?id="+o.id,"_blank","noopener")}async function H(o){const e={planned:!0,voting:0};await y.updateRecipe(m.value.userId,o,e),await p(),y.uploadRecipeToGithub(m.value.userId,null)}async function W(){T.value().then(async o=>{if(o){let e=h.value;for(const r of e){const k={voting:0};await y.updateRecipe(m.value.userId,r.id,k)}await p()}})}async function X(o){const e={voting:0};await y.updateRecipe(m.value.userId,o,e),await p()}async function tt(){Z.value().then(async o=>{if(o){let e=_.value;for(const r of e){const k={planned:!1,voting:0,cooked:!1,ordered:!1};await y.updateRecipe(m.value.userId,r.id,k)}await p(),y.uploadRecipeToGithub(m.value.userId,null)}})}async function et(){const o=_.value.filter(e=>!e.ordered).map(e=>e.id);o&&o.length>0&&S.value(o).then(e=>{p()})}async function Y(o){const e={planned:!1,voting:0,cooked:!1,ordered:!1};await y.updateRecipe(m.value.userId,o,e),await p(),y.uploadRecipeToGithub(m.value.userId,null)}async function p(){b.value=await A.getAllRecipes(m.value.userId)}function L(o){S.value(o).then(e=>{p()})}function nt(o){G.value(o)}return(o,e)=>{const r=u("v-btn"),k=u("v-app-bar-title"),z=u("v-app-bar"),P=u("v-rating"),w=u("v-icon"),ot=u("v-carousel-item"),lt=u("v-carousel"),st=u("v-divider"),V=u("v-list-item-title"),D=u("v-list-item"),at=u("v-list"),it=u("v-menu"),rt=u("v-toolbar"),dt=u("v-img"),ut=u("v-card"),ct=u("v-col"),vt=u("v-row");return n(),f("div",null,[i(z,{color:v(I)?null:"rgb(89, 135, 184)"},{default:l(()=>[i(k,null,{default:l(()=>[i(r,{to:"/recipes","prepend-icon":"mdi-chef-hat",variant:"plain"},{default:l(()=>[...e[4]||(e[4]=[c("Cookio",-1)])]),_:1})]),_:1}),i(r,{"prepend-icon":"mdi-home-search",to:"/recipes"},{default:l(()=>[...e[5]||(e[5]=[c(" Rezeptübersicht ",-1)])]),_:1})]),_:1},8,["color"]),s("div",wt,[e[13]||(e[13]=s("h2",{class:"mt-6 text-center"},"~ Vorschläge ~",-1)),v(h)&&v(h).length>0?(n(),d(r,{key:0,variant:"plain",class:"text-center",onClick:W},{default:l(()=>[...e[6]||(e[6]=[c("Alle Likes entfernen",-1)])]),_:1})):a("",!0),s("div",xt,[v(h).length===0?(n(),f("div",Ct,[...e[7]||(e[7]=[s("div",{style:{"font-size":"1.2em"}},"Keine Vorschläge vorhanden!",-1)])])):a("",!0),v(h).length>0?(n(),d(lt,{key:1,"hide-delimiter-background":"","hide-delimiters":v(h).length===1},{default:l(()=>[(n(!0),f(E,null,F(v(h),t=>(n(),d(ot,{cover:"",src:U(t),key:t.id},{default:l(()=>[s("div",It,[s("div",zt,[t.rating?(n(),f("div",Pt,[i(P,{modelValue:t.rating,"onUpdate:modelValue":g=>t.rating=g,hover:"",length:"5",size:"20",readonly:"",color:"white"},null,8,["modelValue","onUpdate:modelValue"])])):a("",!0),!t.duration&&!t.tags&&!(t.sectionsInProgress||t.ingredientsInProgress||t.imageInProgress)?(n(),f("div",Vt,[s("span",null,[i(w,{icon:"mdi-information-slab-circle"}),e[8]||(e[8]=c()),e[9]||(e[9]=s("b",null,"Nur Zutatenliste vorhanden!",-1))])])):a("",!0),s("div",Dt,[t.duration?(n(),f("span",At,[s("b",null,R(t.duration)+" Min.",1),e[10]||(e[10]=c(" | ",-1))])):a("",!0),s("span",null,[s("b",null,R(t.voting)+" x 👍",1)])])]),s("div",St,[s("span",{onClick:g=>$(t),style:{cursor:"pointer","text-decoration-line":"none","font-weight":"700","font-size":"2.04em",color:"#ffffff !important","background-color":"rgba(93,93,93,0.66)",hyphens:"auto","overflow-wrap":"break-word"},class:"text-medium-emphasis"},R(t.title),9,$t)]),s("div",null,[i(r,{onClick:g=>H(t.id),variant:"flat",color:"rgba(198, 217, 238, 0.7)",height:"50"},{default:l(()=>[...e[11]||(e[11]=[c("Rezept einplanen",-1)])]),_:1},8,["onClick"])]),s("div",null,[i(r,{onClick:g=>X(t.id),variant:"flat",color:"rgb(238 198 198 / 70%)",class:"mt-1"},{default:l(()=>[...e[12]||(e[12]=[c("Ignorieren",-1)])]),_:1},8,["onClick"])])])]),_:2},1032,["src"]))),128))]),_:1},8,["hide-delimiters"])):a("",!0)])]),i(st,{class:"mt-4"}),s("div",Mt,[e[26]||(e[26]=s("h2",{class:"mt-6 text-center"},"~ Geplant ~",-1)),s("div",Nt,[v(_)&&v(_).length>0?(n(),d(r,{key:0,variant:"outlined",onClick:et,disabled:!v(K)||v(K).length===0},{default:l(()=>[...e[14]||(e[14]=[c("Alle Zutaten einkaufen",-1)])]),_:1},8,["disabled"])):a("",!0),v(_)&&v(_).length>0?(n(),d(r,{key:1,variant:"outlined",class:"ml-2",color:"red",onClick:tt},{default:l(()=>[...e[15]||(e[15]=[c("Alle entfernen",-1)])]),_:1})):a("",!0)]),i(vt,{class:"text-center mt-2"},{default:l(()=>[v(_).length===0?(n(),f("div",Bt,[...e[16]||(e[16]=[s("div",{style:{"font-size":"1.2em"}},"Keine geplanten Rezepte gefunden!",-1)])])):a("",!0),(n(!0),f(E,null,F(v(_),t=>(n(),d(ct,{cols:"12",sm:"12",md:"6",lg:"4",xl:"3",key:t.id},{default:l(()=>[i(ut,{class:"mx-auto","max-width":"374"},{default:l(()=>[(n(),d(dt,{class:"position-relative",height:"200",src:U(t),key:B.value[t.id]?B.value[t.id]:0,color:"grey",cover:""},{default:l(()=>[s("div",Tt,[t.duration?(n(),f("div",Zt,[s("b",null,R(t.duration)+" Min.",1)])):a("",!0),s("div",Gt,[t.duration||t.tags?(n(),f("a",{key:0,target:"_blank",href:"/recipes/go?id="+t.id,style:{"text-decoration-line":"none",color:"#ffffff","background-color":"rgba(93,93,93,0.66)"},class:"pa-1"},R(t.title),9,Kt)):a("",!0),t.duration||t.tags?a("",!0):(n(),f("span",Ut,R(t.title),1))])]),s("div",Yt,[s("div",Lt,[t.ordered?(n(),d(w,{key:0,icon:"mdi-check-bold"})):a("",!0),t.ordered?a("",!0):(n(),d(w,{key:1,icon:"mdi-close-thick",color:"red"})),e[17]||(e[17]=c()),e[18]||(e[18]=s("b",null,"Zutaten bestellt",-1))]),t.duration||t.tags?(n(),f("div",jt,[t.cooked?(n(),d(w,{key:0,icon:"mdi-check-bold"})):a("",!0),t.cooked?a("",!0):(n(),d(w,{key:1,icon:"mdi-close-thick",color:"red"})),t.cooked?a("",!0):(n(),f("b",Ot,"Noch nicht zubereitet")),t.cooked&&!t.lastCookedAt?(n(),f("b",Et,"Rezept zubereitet")):a("",!0),t.cooked&&t.lastCookedAt?(n(),f("b",Ft,"Zubereitet am "+R(v(Rt)(t.lastCookedAt)),1)):a("",!0)])):a("",!0)]),i(rt,{color:"transparent"},{append:l(()=>[i(it,null,{activator:l(({props:g})=>[!t.imageInProgress&&!t.sectionsInProgress&&!t.ingredientsInProgress?(n(),d(r,ht({key:0,icon:"mdi-dots-vertical",color:"white"},{ref_for:!0},g),{default:l(()=>[i(w,{icon:"mdi-dots-vertical",size:"35"})]),_:1},16)):a("",!0)]),default:l(()=>[i(at,null,{default:l(()=>[i(D,{onClick:g=>L(t.id)},{default:l(()=>[i(V,null,{default:l(()=>[...e[19]||(e[19]=[c("Zutaten einkaufen",-1)])]),_:1})]),_:1},8,["onClick"]),t.duration||t.tags?(n(),d(D,{key:0,onClick:g=>$(t,!0)},{default:l(()=>[i(V,null,{default:l(()=>[...e[20]||(e[20]=[c("Rezept zubereiten",-1)])]),_:1})]),_:1},8,["onClick"])):a("",!0),v(I)?a("",!0):(n(),d(D,{key:1,onClick:g=>nt(t)},{default:l(()=>[i(V,null,{default:l(()=>[...e[21]||(e[21]=[c("Daten importieren",-1)])]),_:1})]),_:1},8,["onClick"])),i(D,{onClick:g=>Y(t.id)},{default:l(()=>[i(V,null,{default:l(()=>[...e[22]||(e[22]=[c("Aus Planung entfernen",-1)])]),_:1})]),_:1},8,["onClick"])]),_:2},1024)]),_:2},1024)]),_:2},1024)]),_:2},1032,["src"])),s("div",Jt,[!t.ordered&&!t.cooked?(n(),d(r,{key:0,variant:"outlined",onClick:g=>L(t.id)},{default:l(()=>[...e[23]||(e[23]=[c("Zutaten einkaufen",-1)])]),_:1},8,["onClick"])):a("",!0)]),s("div",Qt,[t.ordered&&!t.cooked&&(t.duration||t.tags)?(n(),d(r,{key:0,variant:"outlined",onClick:g=>$(t,!0),color:"blue"},{default:l(()=>[...e[24]||(e[24]=[c("Rezept zubereiten",-1)])]),_:1},8,["onClick"])):a("",!0)]),s("div",qt,[(t.duration||t.tags)&&t.cooked||!(t.duration||t.tags)&&t.ordered?(n(),d(r,{key:0,variant:"outlined",onClick:g=>Y(t.id)},{default:l(()=>[...e[25]||(e[25]=[c("Aus Planung entfernen",-1)])]),_:1},8,["onClick"])):a("",!0)])]),_:2},1024)]),_:2},1024))),128))]),_:1})]),i(ft,{onResult:e[0]||(e[0]=t=>S.value=t)}),i(mt,{onResult:e[1]||(e[1]=t=>G.value=t)}),i(j,{onResult:e[2]||(e[2]=t=>T.value=t),title:"Bitte bestätigen",message:"Sollen alle vorgeschlagenen Rezepte entfernt werden?"}),i(j,{onResult:e[3]||(e[3]=t=>Z.value=t),title:"Bitte bestätigen",message:"Sollen alle geplanten Rezepte aus der Planung entfernt werden?"})])}}},Wt=kt(Ht,[["__scopeId","data-v-75214d84"]]),ne={__name:"index",setup(C){return Q(async()=>{J()}),(A,b)=>(n(),d(Wt))}};export{ne as default};
