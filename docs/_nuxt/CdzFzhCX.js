import{I as fe,C as j,R as y}from"./BtQNCQtE.js";import{u as ge,R as me}from"./DJaDvaNb.js";import{L as _e,_ as pe,M as O,N as ke,J as ye,O as be,K as J,r as x,o as Q,k as $,g as u,x as f,y as n,B as i,z as l,C as s,D as c,P as v,Q as d,R as a,S as E,T as F,A as R,U as he}from"./0zSEY3Y_.js";function Re(I){return I?_e(I).format("DD.MM.YYYY"):"-"}const we={class:"text-center"},xe={class:"text-center"},Ie={key:0,class:"text-center mt-8 text-high-emphasis",style:{width:"100%"}},Ce={class:"mx-auto"},Pe={style:{"background-color":"rgba(93,93,93,0.66)"}},ze={key:0,class:"px-1 pb-1"},Ve={key:1,class:"pa-1 text-white",style:{"font-size":"0.8em"}},De={class:"text-white"},Ae={key:0,class:"px-1"},Ue={class:"ma-2"},Se=["onClick"],$e={style:{width:"100%"}},Me={style:{width:"100%"},class:"text-right mt-2"},Ne={key:0,class:"text-center mt-8 text-high-emphasis",style:{width:"100%"}},Be={class:"overlay-bottom-right"},Te={key:0,style:{"background-color":"rgba(93,93,93,0.66)"},class:"px-1"},Ze={style:{"font-size":"1.1em"},class:"px-1"},Ge=["href"],Ke={key:1,style:{"text-decoration-line":"none",color:"#ffffff","background-color":"rgba(93,93,93,0.66)"},class:"pa-1"},Ye={class:"overlay-top-left pa-1",style:{"font-size":"0.8em"}},Le={style:{"background-color":"rgba(93,93,93,0.66)"},class:"pa-1"},je={key:0,style:{"background-color":"rgba(93,93,93,0.66)"},class:"pa-1"},Oe={key:2},Ee={key:3},Fe={key:4},Je={class:"ma-2"},Qe={class:"ma-2"},qe={class:"ma-2"},He={__name:"MealPlanner",setup(I){const A=ge(),{recipes:b}=O(A);ke(),ye(),be();const M=J(),{authInfo:m,githubMode:C,lanAddress:q}=O(M),N=x({}),U=x(null),B=x(null),T=x(null),Z=x(null);Q(async()=>{await M.getAuthInfo(),await k()});const G=$(()=>_.value.filter(o=>!o.ordered)),h=$(()=>b.value?(b.value=b.value.sort((o,t)=>{const r=o.rating,p=t.rating,P=typeof r=="number"&&r!==null,z=typeof p=="number"&&p!==null;return!P&&!z?0:P?z?p-r:-1:1}),b.value.filter(o=>!!o.voting)):[]),_=$(()=>b.value.filter(o=>!!o.planned));function K(o){return C.value?"https://mmhhhh.de/data/home/recipes/"+o.id+"/image.jpg":q.value+"api/"+m.value.userId+"/recipes/"+o.id+"/image"}async function S(o,t=!1){C.value?window.open("https://mmhhhh.de/recipes/go?id="+o.id,"_blank","noopener"):window.open("/recipes/go?id="+o.id,"_blank","noopener")}async function H(o){const t={planned:!0,voting:0};await y.updateRecipe(m.value.userId,o,t),await k(),y.uploadRecipeToGithub(m.value.userId,null)}async function W(){B.value().then(async o=>{if(o){let t=h.value;for(const r of t){const p={voting:0};await y.updateRecipe(m.value.userId,r.id,p)}await k()}})}async function X(o){const t={voting:0};await y.updateRecipe(m.value.userId,o,t),await k()}async function ee(){T.value().then(async o=>{if(o){let t=_.value;for(const r of t){const p={planned:!1,voting:0,cooked:!1,ordered:!1};await y.updateRecipe(m.value.userId,r.id,p)}await k(),y.uploadRecipeToGithub(m.value.userId,null)}})}async function te(){const o=_.value.filter(t=>!t.ordered).map(t=>t.id);o&&o.length>0&&U.value(o).then(t=>{k()})}async function Y(o){const t={planned:!1,voting:0,cooked:!1,ordered:!1};await y.updateRecipe(m.value.userId,o,t),await k(),y.uploadRecipeToGithub(m.value.userId,null)}async function k(){b.value=await A.getAllRecipes(m.value.userId)}function L(o){U.value(o).then(t=>{k()})}function ne(o){Z.value(o)}return(o,t)=>{const r=u("v-btn"),p=u("v-app-bar-title"),P=u("v-app-bar"),z=u("v-rating"),w=u("v-icon"),oe=u("v-carousel-item"),se=u("v-carousel"),le=u("v-divider"),V=u("v-list-item-title"),D=u("v-list-item"),ae=u("v-list"),ie=u("v-menu"),re=u("v-toolbar"),de=u("v-img"),ue=u("v-card"),ce=u("v-col"),ve=u("v-row");return n(),f("div",null,[i(P,{color:v(C)?null:"rgb(89, 135, 184)"},{default:s(()=>[i(p,null,{default:s(()=>[i(r,{to:"/recipes","prepend-icon":"mdi-chef-hat",variant:"plain"},{default:s(()=>[...t[4]||(t[4]=[c("Cookio",-1)])]),_:1})]),_:1}),i(r,{"prepend-icon":"mdi-home-search",to:"/recipes"},{default:s(()=>[...t[5]||(t[5]=[c(" Rezeptübersicht ",-1)])]),_:1})]),_:1},8,["color"]),l("div",we,[t[13]||(t[13]=l("h2",{class:"mt-6 text-center"},"~ Vorschläge ~",-1)),v(h)&&v(h).length>0?(n(),d(r,{key:0,variant:"plain",class:"text-center",onClick:W},{default:s(()=>[...t[6]||(t[6]=[c("Alle Likes entfernen",-1)])]),_:1})):a("",!0),l("div",xe,[v(h).length===0?(n(),f("div",Ie,[...t[7]||(t[7]=[l("div",{style:{"font-size":"1.2em"}},"Keine Vorschläge vorhanden!",-1)])])):a("",!0),v(h).length>0?(n(),d(se,{key:1,"hide-delimiter-background":"","hide-delimiters":v(h).length===1},{default:s(()=>[(n(!0),f(E,null,F(v(h),e=>(n(),d(oe,{cover:"",src:K(e),key:e.id},{default:s(()=>[l("div",Ce,[l("div",Pe,[e.rating?(n(),f("div",ze,[i(z,{modelValue:e.rating,"onUpdate:modelValue":g=>e.rating=g,hover:"",length:"5",size:"20",readonly:"",color:"white"},null,8,["modelValue","onUpdate:modelValue"])])):a("",!0),!e.ingredientsInProgress&&!e.sectionsInProgress&&!e.imageInProgress&&!e.sectionsUploaded?(n(),f("div",Ve,[l("span",null,[i(w,{icon:"mdi-information-slab-circle"}),t[8]||(t[8]=c()),t[9]||(t[9]=l("b",null,"Nur Zutatenliste vorhanden!",-1))])])):a("",!0),l("div",De,[e.duration?(n(),f("span",Ae,[l("b",null,R(e.duration)+" Min.",1),t[10]||(t[10]=c(" | ",-1))])):a("",!0),l("span",null,[l("b",null,R(e.voting)+" x 👍",1)])])]),l("div",Ue,[l("span",{onClick:g=>S(e),style:{cursor:"pointer","text-decoration-line":"none","font-weight":"700","font-size":"2.04em",color:"#ffffff !important","background-color":"rgba(93,93,93,0.66)",hyphens:"auto","overflow-wrap":"break-word"},class:"text-medium-emphasis"},R(e.title),9,Se)]),l("div",null,[i(r,{onClick:g=>H(e.id),variant:"flat",color:"rgba(198, 217, 238, 0.7)",height:"50"},{default:s(()=>[...t[11]||(t[11]=[c("Rezept einplanen",-1)])]),_:1},8,["onClick"])]),l("div",null,[i(r,{onClick:g=>X(e.id),variant:"flat",color:"rgb(238 198 198 / 70%)",class:"mt-1"},{default:s(()=>[...t[12]||(t[12]=[c("Ignorieren",-1)])]),_:1},8,["onClick"])])])]),_:2},1032,["src"]))),128))]),_:1},8,["hide-delimiters"])):a("",!0)])]),i(le,{class:"mt-4"}),l("div",$e,[t[26]||(t[26]=l("h2",{class:"mt-6 text-center"},"~ Geplant ~",-1)),l("div",Me,[v(_)&&v(_).length>0?(n(),d(r,{key:0,variant:"outlined",onClick:te,disabled:!v(G)||v(G).length===0},{default:s(()=>[...t[14]||(t[14]=[c("Alle Zutaten einkaufen",-1)])]),_:1},8,["disabled"])):a("",!0),v(_)&&v(_).length>0?(n(),d(r,{key:1,variant:"outlined",class:"ml-2",color:"red",onClick:ee},{default:s(()=>[...t[15]||(t[15]=[c("Alle entfernen",-1)])]),_:1})):a("",!0)]),i(ve,{class:"text-center mt-2"},{default:s(()=>[v(_).length===0?(n(),f("div",Ne,[...t[16]||(t[16]=[l("div",{style:{"font-size":"1.2em"}},"Keine geplanten Rezepte gefunden!",-1)])])):a("",!0),(n(!0),f(E,null,F(v(_),e=>(n(),d(ce,{cols:"12",sm:"12",md:"6",lg:"4",xl:"3",key:e.id},{default:s(()=>[i(ue,{class:"mx-auto","max-width":"374"},{default:s(()=>[(n(),d(de,{class:"position-relative",height:"200",src:K(e),key:N.value[e.id]?N.value[e.id]:0,color:"grey",cover:""},{default:s(()=>[l("div",Be,[e.duration?(n(),f("div",Te,[l("b",null,R(e.duration)+" Min.",1)])):a("",!0),l("div",Ze,[!e.ingredientsInProgress&&!e.sectionsInProgress&&e.sectionsUploaded?(n(),f("a",{key:0,target:"_blank",href:"/recipes/go?id="+e.id,style:{"text-decoration-line":"none",color:"#ffffff","background-color":"rgba(93,93,93,0.66)"},class:"pa-1"},R(e.title),9,Ge)):a("",!0),!e.ingredientsInProgress&&!e.sectionsInProgress&&!e.sectionsUploaded?(n(),f("span",Ke,R(e.title),1)):a("",!0)])]),l("div",Ye,[l("div",Le,[e.ordered?(n(),d(w,{key:0,icon:"mdi-check-bold"})):a("",!0),e.ordered?a("",!0):(n(),d(w,{key:1,icon:"mdi-close-thick",color:"red"})),t[17]||(t[17]=c()),t[18]||(t[18]=l("b",null,"Zutaten bestellt",-1))]),e.sectionsUploaded&&!e.sectionsInProgress?(n(),f("div",je,[e.cooked?(n(),d(w,{key:0,icon:"mdi-check-bold"})):a("",!0),e.cooked?a("",!0):(n(),d(w,{key:1,icon:"mdi-close-thick",color:"red"})),e.cooked?a("",!0):(n(),f("b",Oe,"Noch nicht zubereitet")),e.cooked&&!e.lastCookedAt?(n(),f("b",Ee,"Rezept zubereitet")):a("",!0),e.cooked&&e.lastCookedAt?(n(),f("b",Fe,"Zubereitet am "+R(v(Re)(e.lastCookedAt)),1)):a("",!0)])):a("",!0)]),i(re,{color:"transparent"},{append:s(()=>[i(ie,null,{activator:s(({props:g})=>[!e.imageInProgress&&!e.sectionsInProgress&&!e.ingredientsInProgress?(n(),d(r,he({key:0,icon:"mdi-dots-vertical",color:"white"},{ref_for:!0},g),{default:s(()=>[i(w,{icon:"mdi-dots-vertical",size:"35"})]),_:1},16)):a("",!0)]),default:s(()=>[i(ae,null,{default:s(()=>[i(D,{onClick:g=>L(e.id)},{default:s(()=>[i(V,null,{default:s(()=>[...t[19]||(t[19]=[c("Zutaten einkaufen",-1)])]),_:1})]),_:1},8,["onClick"]),e.sectionsUploaded&&!e.sectionsInProgress?(n(),d(D,{key:0,onClick:g=>S(e,!0)},{default:s(()=>[i(V,null,{default:s(()=>[...t[20]||(t[20]=[c("Rezept zubereiten",-1)])]),_:1})]),_:1},8,["onClick"])):a("",!0),v(C)?a("",!0):(n(),d(D,{key:1,onClick:g=>ne(e)},{default:s(()=>[i(V,null,{default:s(()=>[...t[21]||(t[21]=[c("Daten importieren",-1)])]),_:1})]),_:1},8,["onClick"])),i(D,{onClick:g=>Y(e.id)},{default:s(()=>[i(V,null,{default:s(()=>[...t[22]||(t[22]=[c("Aus Planung entfernen",-1)])]),_:1})]),_:1},8,["onClick"])]),_:2},1024)]),_:2},1024)]),_:2},1024)]),_:2},1032,["src"])),l("div",Je,[!e.ordered&&!e.cooked?(n(),d(r,{key:0,variant:"outlined",onClick:g=>L(e.id)},{default:s(()=>[...t[23]||(t[23]=[c("Zutaten einkaufen",-1)])]),_:1},8,["onClick"])):a("",!0)]),l("div",Qe,[e.ordered&&!e.cooked&&e.sectionsUploaded&&!e.sectionsInProgress?(n(),d(r,{key:0,variant:"outlined",onClick:g=>S(e,!0),color:"blue"},{default:s(()=>[...t[24]||(t[24]=[c("Rezept zubereiten",-1)])]),_:1},8,["onClick"])):a("",!0)]),l("div",qe,[e.sectionsUploaded&&!e.sectionsInProgress&&e.cooked||!(e.sectionsUploaded&&!e.sectionsInProgress)&&e.ordered?(n(),d(r,{key:0,variant:"outlined",onClick:g=>Y(e.id)},{default:s(()=>[...t[25]||(t[25]=[c("Aus Planung entfernen",-1)])]),_:1},8,["onClick"])):a("",!0)])]),_:2},1024)]),_:2},1024))),128))]),_:1})]),i(fe,{onResult:t[0]||(t[0]=e=>U.value=e)}),i(me,{onResult:t[1]||(t[1]=e=>Z.value=e)}),i(j,{onResult:t[2]||(t[2]=e=>B.value=e),title:"Bitte bestätigen",message:"Sollen alle vorgeschlagenen Rezepte entfernt werden?"}),i(j,{onResult:t[3]||(t[3]=e=>T.value=e),title:"Bitte bestätigen",message:"Sollen alle geplanten Rezepte aus der Planung entfernt werden?"})])}}},We=pe(He,[["__scopeId","data-v-786f435b"]]),nt={__name:"index",setup(I){return Q(async()=>{J()}),(A,b)=>(n(),d(We))}};export{nt as default};
