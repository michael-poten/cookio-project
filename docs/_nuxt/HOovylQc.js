import{U as ye,V as ke,K as ae,W as ne,_ as oe,M as xe,r as o,L as _e,u as Ie,X as be,o as ie,Y as Ce,g as c,x as r,y as s,B as t,C as n,Q as u,P as Z,Z as S,D as a,z as i,$ as D,O as W,a0 as F,a1 as we}from"./CdLjPFv7.js";import{a as B,I as Se}from"./B7YJNDpV.js";const We=ye("recipe",{state:()=>ke({recipes:[]}),actions:{getAllRecipes:async function(N){const M=ae();try{let g;M.isNetworkAccess?g=M.lanAddress+"api/"+N+"/recipes":g="https://mmhhhh.de/data/home/recipes.json";let y=(await ne.get(g)).data;const v=[];for(const[k,U]of Object.entries(y))v.push(U);return this.$patch({recipes:v}),v}catch(g){ne.catchError(g)}}}}),he={key:0},De={key:1},Fe={key:2},$e={key:0},Me={key:0},Re={key:1,class:"mt-3"},Ue={key:2,class:"mt-3"},ze={class:"d-flex flex-no-wrap justify-space-between"},Ae={key:0,class:"mt-3"},Te={key:1},je={class:"d-flex flex-no-wrap justify-space-between"},Ve={key:0,class:"mt-3"},Ee={key:1},Be={key:0},Ze={key:1,class:"mt-3"},Ne={key:2,class:"mt-3"},He={__name:"RecipeImportDialog",emits:["result"],setup(N,{emit:M}){const g=xe(),y=o(null),v=o(null),k=o(null),U=ae(),{authInfo:m}=_e(U),K=M;Ie(),be();const I=o(!1),R=o(null),_=o(null),b=o(null),f=o(!1),p=o(null),x=o(!1),z=o(null),A=o(!1),T=o(null),j=o(!1),$=o(!1),H=o(!1),J=o(!1);o(!0);const L=o(!0),P=o(!0),O=o([]),Q=o([]);ie(async()=>{K("result",async l=>(console.log("recipeInput",l),p.value=null,z.value=null,T.value=null,y.value=null,v.value=null,k.value=null,x.value=!1,A.value=!1,j.value=!1,$.value=!1,l?(b.value=l.id,f.value=!0,l.sectionsUploaded?(console.log("sectionsUploaded"),P.value=!1):P.value=!0,L.value=!1):(b.value=te(),L.value=!0,P.value=!0),I.value=!0,new Promise((e,d)=>{R.value=e,_.value=d})))}),Ce(O,l=>{Q.value=[...l].sort((e,d)=>e.name.localeCompare(d.name)),fe(Q.value)});function se(){I.value=!1,R.value(null)}function ue(){I.value=!1,R.value(b.value)}function X(l){const e=l.target.files;e&&e.length>0&&(y.value=e[0]),Y()}function de(l){const e=l.dataTransfer.files;e&&e.length>0&&(y.value=e[0]),Y()}function re(l){const e=l.dataTransfer.files;if(e&&e.length>0){const d=Array.from(e);O.value=Array.from(d)}}async function Y(){if(y.value){x.value=!0;try{p.value=(await B.analyzeIngredients(m.value.userId,b.value,y.value)).data,x.value=!1}catch{x.value=!1}}}function q(l){const e=l.target.files;e&&e.length>0&&(v.value=e[0]),G()}function ve(l){const e=l.dataTransfer.files;e&&e.length>0&&(v.value=e[0]),G()}async function G(){if(console.log("uploadSectionsFile"),!!v.value&&!(!p.value&&!f.value)){A.value=!0;try{z.value=(await B.analyzeSections(m.value.userId,b.value,v.value)).data}catch{}}}function ee(l){const e=l.target.files;e&&e.length>0&&(k.value=e[0]),le()}function pe(l){const e=l.dataTransfer.files;e&&e.length>0&&(k.value=e[0]),le()}async function le(){if(console.log("uploadImageFile"),!!k.value&&!(!p.value&&!f.value)){j.value=!0;try{T.value=(await B.uploadImage(m.value.userId,b.value,k.value)).data}catch{}}}function te(){return"xxxxxxxx-xxxx-4xxx-yxxx-xxxxxxxxxxxx".replace(/[xy]/g,function(l){const e=Math.random()*16|0;return(l==="x"?e:e&3|8).toString(16)})}function ce(l){const e=Array.from(l.target.files);O.value=e}async function fe(l){H.value=!0;try{for(let e=0;e<l.length;e+=2){const d=l[e],h=l[e+1]||null,C=te();await B.analyzeIngredients(m.value.userId,C,d),await B.analyzeSections(m.value.userId,C,h),console.log("analyzeIngredients file1 ",d.name),console.log("analyzeIngredients file2 ",h.name)}}catch{}H.value=!1,x.value=!1,setTimeout(()=>{I.value=!1,R.value(!0)},500)}return(l,e)=>{const d=c("v-btn"),h=c("v-card-title"),C=c("v-icon"),V=c("v-card-text"),E=c("v-card"),me=c("v-card-actions"),ge=c("v-dialog");return s(),r("div",null,[t(ge,{"max-width":"600",modelValue:I.value,"onUpdate:modelValue":e[12]||(e[12]=w=>I.value=w)},{default:n(()=>[t(E,{class:"pa-4",style:{"background-color":"white"}},{default:n(()=>[t(h,null,{default:n(()=>[f.value?u("",!0):(s(),r("div",he,"Rezept hinzufügen")),f.value?(s(),r("div",De,"Rezeptdaten importieren")):u("",!0),f.value?u("",!0):(s(),r("div",Fe,[$.value?u("",!0):(s(),Z(d,{key:0,variant:"plain",style:{"font-size":"0.7em"},onClick:e[0]||(e[0]=S(w=>$.value=!0,["prevent"])),"prepend-icon":"mdi-arrow-right"},{default:n(()=>[...e[13]||(e[13]=[a("Zum Multi-Dateiupload",-1)])]),_:1}))]))]),_:1}),t(V,null,{default:n(()=>[$.value?u("",!0):(s(),r("div",$e,[L.value?(s(),r("div",{key:0,onDrop:S(de,["prevent"]),onDragover:e[3]||(e[3]=S(()=>{},["prevent"]))},[t(E,{rounded:"",loading:x.value},{default:n(()=>[i("div",null,[i("div",null,[t(h,null,{default:n(()=>[...e[14]||(e[14]=[a(" Zutatenliste ",-1)])]),_:1}),t(V,null,{default:n(()=>[e[19]||(e[19]=a(" Erkennt sämtliche Zutaten aus der Zutatenliste. Dabei wird insbesondere der Fokus auf die Menge und den Namen gelegt. ",-1)),!x.value&&!p.value&&!y.value?(s(),r("div",Me,[i("div",null,[t(d,{class:"mt-3",rounded:"",variant:"outlined",text:"","prepend-icon":"mdi-cloud-upload-outline",onClick:e[1]||(e[1]=w=>l.$refs.uploadIngredients.click())},{default:n(()=>[...e[15]||(e[15]=[a("Bild hochladen ",-1)])]),_:1})]),i("div",null,[W(g).smAndDown.value?(s(),Z(d,{key:0,class:"mt-1",rounded:"",variant:"outlined",text:"","prepend-icon":"mdi-camera-enhance",onClick:e[2]||(e[2]=w=>l.$refs.uploadIngredientsCamera.click())},{default:n(()=>[...e[16]||(e[16]=[a("Foto machen ",-1)])]),_:1})):u("",!0)])])):u("",!0),x.value&&!p.value?(s(),r("div",Re,[t(C,{icon:"mdi-sync"}),e[17]||(e[17]=a(" Analyse läuft... ",-1))])):u("",!0),p.value?(s(),r("div",Ue,[t(C,{icon:"mdi-check"}),e[18]||(e[18]=a(" Upload abgeschlossen. ",-1))])):u("",!0)]),_:1})])]),D(i("input",{type:"file",id:"uploadIngredients",ref:"uploadIngredients",onChange:X,accept:"image/png,image/jpeg"},null,544),[[F,!1]]),D(i("input",{type:"file",id:"uploadIngredientsCamera",ref:"uploadIngredientsCamera",capture:"environment",onChange:X,accept:"image/png,image/jpeg"},null,544),[[F,!1]])]),_:1},8,["loading"])],32)):u("",!0),P.value?(s(),r("div",{key:1,class:"mt-2",onDrop:S(ve,["prevent"]),onDragover:e[6]||(e[6]=S(()=>{},["prevent"]))},[t(E,null,{default:n(()=>[i("div",ze,[i("div",null,[t(h,null,{default:n(()=>[...e[20]||(e[20]=[a(" Tätigkeitsschritte ",-1)])]),_:1}),t(V,null,{default:n(()=>[e[24]||(e[24]=a(" Erfasst alle Arbeitsschritte, den Titel, die Zubereitungsdauer und generiert Schlagwörter. Wird im Hintergrund analysiert. ",-1)),v.value&&!z.value&&A.value?(s(),r("div",Ae,[t(C,{icon:"mdi-check"}),e[21]||(e[21]=a(" Upload abgeschlossen. ",-1))])):u("",!0),v.value?u("",!0):(s(),r("div",Te,[i("div",null,[t(d,{class:"mt-3",rounded:"",variant:"outlined",text:"",disabled:!p.value&&!f.value,"prepend-icon":"mdi-cloud-upload-outline",onClick:e[4]||(e[4]=w=>l.$refs.uploadSections.click())},{default:n(()=>[...e[22]||(e[22]=[a("Bild hochladen ",-1)])]),_:1},8,["disabled"])]),i("div",null,[W(g).smAndDown.value?(s(),Z(d,{key:0,class:"mt-1",rounded:"",variant:"outlined",text:"",disabled:!p.value&&!f.value,"prepend-icon":"mdi-camera-enhance",onClick:e[5]||(e[5]=w=>l.$refs.uploadSectionsCamera.click())},{default:n(()=>[...e[23]||(e[23]=[a("Foto machen ",-1)])]),_:1},8,["disabled"])):u("",!0)])]))]),_:1})])]),D(i("input",{type:"file",id:"uploadSections",ref:"uploadSections",onChange:q,accept:"image/png,image/jpeg"},null,544),[[F,!1]]),D(i("input",{type:"file",id:"uploadSectionsCamera",ref:"uploadSectionsCamera",capture:"environment",onChange:q,accept:"image/png,image/jpeg"},null,544),[[F,!1]])]),_:1})],32)):u("",!0),i("div",{class:"mt-2",onDrop:S(pe,["prevent"]),onDragover:e[9]||(e[9]=S(()=>{},["prevent"]))},[t(E,null,{default:n(()=>[i("div",je,[i("div",null,[t(h,null,{default:n(()=>[...e[25]||(e[25]=[a(" Rezeptbild ",-1)])]),_:1}),t(V,null,{default:n(()=>[e[29]||(e[29]=a(" Hier kann ein Bild vom zubereiteten Rezept hochgeladen werden. ",-1)),k.value&&!T.value&&j.value?(s(),r("div",Ve,[t(C,{icon:"mdi-check"}),e[26]||(e[26]=a(" Upload abgeschlossen. ",-1))])):u("",!0),k.value?u("",!0):(s(),r("div",Ee,[i("div",null,[t(d,{class:"mt-3",rounded:"",variant:"outlined",text:"",disabled:!p.value&&!f.value,"prepend-icon":"mdi-cloud-upload-outline",onClick:e[7]||(e[7]=w=>l.$refs.uploadImage.click())},{default:n(()=>[...e[27]||(e[27]=[a("Bild hochladen ",-1)])]),_:1},8,["disabled"])]),i("div",null,[W(g).smAndDown.value?(s(),Z(d,{key:0,class:"mt-1",rounded:"",variant:"outlined",text:"",disabled:!p.value&&!f.value,"prepend-icon":"mdi-camera-enhance",onClick:e[8]||(e[8]=w=>l.$refs.uploadImageCamera.click())},{default:n(()=>[...e[28]||(e[28]=[a("Foto machen ",-1)])]),_:1},8,["disabled"])):u("",!0)])]))]),_:1})])]),D(i("input",{type:"file",id:"uploadImage",ref:"uploadImage",onChange:ee,accept:"image/png,image/jpeg"},null,544),[[F,!1]]),D(i("input",{type:"file",id:"uploadImageCamera",ref:"uploadImageCamera",capture:"environment",onChange:ee,accept:"image/png,image/jpeg"},null,544),[[F,!1]])]),_:1})],32)])),$.value?(s(),r("div",{key:1,onDrop:S(re,["prevent"]),onDragover:e[11]||(e[11]=S(()=>{},["prevent"]))},[t(E,{rounded:"",loading:H.value},{default:n(()=>[i("div",null,[i("div",null,[t(h,null,{default:n(()=>[...e[30]||(e[30]=[a(" Multi-Dateiupload ",-1)])]),_:1}),t(V,null,{default:n(()=>[e[34]||(e[34]=a(" Erkennt sämtliche Zutaten und Tätigkeitsschritte aus den hochgeladenen Bildern. Die Dateien werden immer pärchenweise entsprechend der alphabetischen Reihenfolge des Dateinamens analysiert. ",-1)),!x.value&&!p.value&&!y.value?(s(),r("div",Be,[i("div",null,[t(d,{class:"mt-3",rounded:"",variant:"outlined",text:"","prepend-icon":"mdi-cloud-upload-outline",onClick:e[10]||(e[10]=w=>l.$refs.uploadMulti.click())},{default:n(()=>[...e[31]||(e[31]=[a("Bilder hochladen ",-1)])]),_:1})])])):u("",!0),H.value&&!J.value?(s(),r("div",Ze,[t(C,{icon:"mdi-sync"}),e[32]||(e[32]=a(" Upload läuft... ",-1))])):u("",!0),J.value?(s(),r("div",Ne,[t(C,{icon:"mdi-check"}),e[33]||(e[33]=a(" Upload abgeschlossen. ",-1))])):u("",!0)]),_:1})])]),D(i("input",{type:"file",id:"uploadMulti",ref:"uploadMulti",multiple:"",onChange:ce,accept:"image/png,image/jpeg"},null,544),[[F,!1]])]),_:1},8,["loading"])],32)):u("",!0)]),_:1}),t(me,null,{default:n(()=>[t(d,{onClick:se,rounded:"",variant:"outlined",text:"",color:"red"},{default:n(()=>[...e[35]||(e[35]=[a(" Abbrechen ",-1)])]),_:1}),t(d,{disabled:!p.value&&!f.value,onClick:ue,rounded:"",variant:"outlined",text:""},{default:n(()=>[...e[36]||(e[36]=[a(" Fertig ",-1)])]),_:1},8,["disabled"])]),_:1})]),_:1})]),_:1},8,["modelValue"]),t(Se)])}}},Je=oe(He,[["__scopeId","data-v-d4c31028"]]),Pe=["innerHTML"],Ke={__name:"ConfirmationDialog",props:{message:{type:String,default:""},title:{type:String,default:""}},emits:["result"],setup(N,{emit:M}){const g=N,y=M,v=o(!1),k=o(g.message),U=o(g.title);let m=null;ie(()=>{y("result",R=>(v.value=!0,new Promise((_,b)=>{m=_})))});function K(){m&&m(!0),v.value=!1,m=null}function I(){m&&m(!1),v.value=!1,m=null}return(R,_)=>{const b=c("v-toolbar"),f=c("v-btn"),p=c("v-col"),x=c("v-row"),z=c("v-container"),A=c("v-card-text"),T=c("v-card"),j=c("v-dialog");return s(),Z(j,{modelValue:v.value,"onUpdate:modelValue":_[0]||(_[0]=$=>v.value=$),onKeydown:we(I,["esc"]),"max-width":"420"},{default:n(()=>[t(T,null,{default:n(()=>[t(b,{color:"rgb(191, 208, 217)",title:U.value},null,8,["title"]),D(t(A,null,{default:n(()=>[i("div",{style:{"margin-bottom":"30px"},innerHTML:k.value},null,8,Pe),t(z,{class:"sub-grid"},{default:n(()=>[t(x,null,{default:n(()=>[t(p,{cols:"6"},{default:n(()=>[t(f,{onClick:I,style:{width:"100%"}},{default:n(()=>[..._[1]||(_[1]=[a("Abbrechen",-1)])]),_:1})]),_:1}),t(p,{cols:"6"},{default:n(()=>[t(f,{color:"secondary",onClick:K,style:{width:"100%"}},{default:n(()=>[..._[2]||(_[2]=[a(" Ja ",-1)])]),_:1})]),_:1})]),_:1})]),_:1})]),_:1},512),[[F,!!k.value]])]),_:1})]),_:1},8,["modelValue"])}}},Qe=oe(Ke,[["__scopeId","data-v-6b314bdd"]]);export{Qe as C,Je as R,We as u};
